Guidelines Web Content Transformation Proxies Guidelines Web Content Transformation Proxies W3C Working Group Note October version: http://www.w3.org/TR/2010/NOTE-ct-guidelines-20101026/ Latest version: http://www.w3.org/TR/ct-guidelines/ Previous version: http://www.w3.org/TR/2010/CR-ct-guidelines-20100617/ Editor: Jo Rabin, Invited Expert mTLD Top Level Domain, dotMobi) CopyrightÂ Â©Â 2010Â W3CÂ® ERCIM, Keio), Rights Reserved. W3C liability, trademark document use rules apply. Abstract document guidance Content Transformation proxies transform Web content. Content Transformation proxies alter requests sent user agents servers responses returned servers so appearance, structure control flow Web applications are modified. Content Transformation proxies are mostly used convert Web sites designed desktop computers form suitable mobile devices. Based current practice standards, document mechanisms Content Transformation proxies make presence known other parties, present outcome alterations performed HTTP traffic, react indications set clients servers constrain alterations. objective reduce undesirable effects Web applications, especially mobile-ready ones, limit diversity modes operation Content Transformation proxies, same time allowing proxies alter content otherwise not display successfully mobile devices. Important considerations regarding impact security are highlighted. Status Document section status document time publication. Other documents supersede document. list current W3C publications latest revision technical report be found W3C technical reports index http://www.w3.org/TR/. document was developed Mobile Web Best Practices Working Group part Mobile Web Initiative. document was expected become W3C Recommendation was published W3C Candidate Recommendation June October Mobile Web Best Practices Working Group lack existing implementations. Nevertheless, also guidelines establish framework acceptable parties involved. Mobile Web Best Practices Working Group eventually resolved discontinue work document publish Working Group Note. Working Group hopes Note serve basis discussion negotiation players. Other changes section, document not changed publication W3C Candidate Recommendation. particular, use normative language been kept as-is. Comments document be sent Working Group's public email list public-bpwg-comments@w3.org public archive). public public-content-transformation-conformance@w3.org mailing-list public archive) had been created gather implementation feedback still be used purpose. Working Group also people willing contribute test case repository let known public-bpwg-comments@w3.org public mailing-list, noting however further work anticipated topic group October check test case repository up-to-date information. Publication Working Group Note not imply endorsement W3C Membership. draft document be updated, replaced obsoleted other documents time. inappropriate cite document other work progress. document was produced group operating February W3C Patent Policy. W3C public list patent disclosures made connection deliverables group; page also instructions disclosing patent. individual actual knowledge patent individual Essential Claim(s) disclose information accordance section W3C Patent Policy. Table Contents Introduction Â Â Â Â Purpose Â Â Â Â Audience Â Â Â Â Scope Â Â Â Â Principles Â Â Â Â Â Â Â Â IAB Considerations Â Â Â Â Â Â Â Â Priority Intention Terminology Â Â Â Â Types Proxy Â Â Â Â Types Transformation Â Â Â Â User Interaction Conformance Â Â Â Â Classes Product Â Â Â Â Normative Informative Parts Â Â Â Â Normative Language Conformance Requirements Â Â Â Â Transformation Deployment Conformance Behavior Components Â Â Â Â Proxy Forwarding Request Â Â Â Â Â Â Â Â Applicable HTTP Methods Â Â Â Â Â Â Â Â no-transform directive Request Â Â Â Â Â Â Â Â Treatment Requesters are not Web browsers Â Â Â Â Â Â Â Â Serving Cached Responses Â Â Â Â Â Â Â Â Alteration HTTP Header Field Values Â Â Â Â Â Â Â Â Â Â Â Â Content Tasting Â Â Â Â Â Â Â Â Â Â Â Â Avoiding Unacceptable" Responses Â Â Â Â Â Â Â Â Â Â Â Â User Selection Restructured Experience Â Â Â Â Â Â Â Â Â Â Â Â Sequence Requests Â Â Â Â Â Â Â Â Â Â Â Â Original Header Fields Â Â Â Â Â Â Â Â Additional HTTP Header Fields Â Â Â Â Â Â Â Â Â Â Â Â Proxy Treatment Via Header Field Â Â Â Â Proxy Forwarding Response User Agent Â Â Â Â Â Â Â Â User Preferences Â Â Â Â Â Â Â Â Receipt Cache-Control: no-transform Â Â Â Â Â Â Â Â Use Cache-Control: no-transform Â Â Â Â Â Â Â Â Server Rejection HTTP Request Â Â Â Â Â Â Â Â Receipt Vary HTTP Header Field Â Â Â Â Â Â Â Â Link Representation Â Â Â Â Â Â Â Â WML Content Â Â Â Â Â Â Â Â Proxy Decision Transform Â Â Â Â Â Â Â Â Â Â Â Â Alteration Response Â Â Â Â Â Â Â Â Â Â Â Â Link Rewriting Â Â Â Â Â Â Â Â Â Â Â Â HTTPS Link Rewriting Testing Appendices References B Conformance Statement C Internet Content Types associated Mobile Content D Internet Content Types associated Data Content E DOCTYPEs Associated Mobile Content F URI Patterns Associated Mobile Web Sites G Summary User Preference Handling H Example Transformation Interactions Â Â Â Â H.1 Basic Content Tasting Proxy Â Â Â Â H.2 Optimization based Previous Server Interaction Â Â Â Â H.3 Optimization based Previous Server Interaction, Server Changed Operation Â Â Â Â H.4 Server Response Indicating Representation Intended Target Device Â Â Â Â H.5 Server Response Indicating Representation Intended Target Device Informative Guidance Origin Servers Â Â Â Â I.1 Server Response Proxy Â Â Â Â Â Â Â Â I.1.1 Use HTTP Status Â Â Â Â Â Â Â Â I.1.2 Use HTTP Status Â Â Â Â Â Â Â Â I.1.3 Server Origination Cache-Control: no-transform Â Â Â Â Â Â Â Â I.1.4 Varying Representations Â Â Â Â Â Â Â Â Â Â Â Â I.1.4.1 Use Vary HTTP Header Field Â Â Â Â Â Â Â Â Â Â Â Â I.1.4.2 Indication Intended Presentation Media Type Representation J Applicability Transforming Solutions are Scope K Scope Future Work Â Â Â Â K.1 POWDER Â Â Â Â K.2 link HTTP Header Field Â Â Â Â K.3 Sources Device Information Â Â Â Â K.4 Inter Proxy Communication Â Â Â Â K.5 Explicit Consent Â Â Â Â K.6 Amendment Refinement HTTP L Acknowledgments Introduction Purpose document Content Transformation manipulation requests responses origin server. manipulation carried proxies order provide better user experience content otherwise result unsatisfactory experience device making request. W3C Mobile Web Best Practices Working Group Content Transformation, being deployed widely mobile data access networks. deployments are widely divergent other, many non-standard HTTP implications, well-understood means identifying presence such transforming proxies, controlling actions. document framework allow happen. overall objective document provide means, far practical, users be provided least user experience" Independence Glossary] Web, mobile, taking account fact increasing number content providers create experiences specially tailored mobile context do not wish be altered third parties. Equally account fact there remain very large number Web sites do not provide functional user experience perceived many mobile devices. stressed document unlikely be last word topic. noted Scope) scope document provide comprehensive solution control transforming proxies, such solution appear be needed. document attempt improve situation point time there be disregard provisions HTTP primarily reminder encouragement follow provisions more closely. Audience audience document creators Content Transformation proxies purchasers operators such proxies. document also non-normative guidance content providers services be accessed means such proxies. Scope recommendations document refer only browsing" i.e. access user agents are intended primarily interaction users HTML Web pages browsers) using HTTP. Clients interact proxies using mechanisms other HTTP typically involve download special client) are scope, are considered be distributed user agent. Proxies are operated control direction operator origin server are similarly considered be distributed origin server hence scope. W3C Mobile Web Best Practices Working Group not chartered create new technology role advise best practice use existing technology. satisfying Content Transformation requirements, existing HTTP header fields, directives behaviors be respected, far practical, extensions HTTP] are be used. recommendations document refer interactions proxy do not refer presumed aspects internal operation proxy. reason, document not discuss use lists discuss behavior induced implementation such lists). addition not discuss details transformation carried reflected interoperability. reason, not discuss insertion insertion headers footers other specific behaviors discuss need essential user interaction form). Moral, legal other similar questions are not scope document. BPWG not have authority expertise comment way setting precedent authorising particular behavior absence. Principles IAB Considerations BPWG made reference Internet Architecture Board work Pluggable Edge Services" OPES] various principles underlie behavior proxies. work IAB expressed concerns privacy, control, monitoring, accountability such services. Priority Intention Web users considerable flexibility respect representation content. same time, Content Providers have preferred manner wish content be represented. Content Transformation reconcile contrasting factors. creating Recommendation BPWG determined Content Transformation proxies respect Content Providers intentions, are expressed, allow users choose other representations, Content Providers specifically prohibit BPWG there systematic vocabulary Content Provider Intentions, systematic means expression such intentions. scope further work area K Scope Future Work). Terminology Types Proxy Alteration HTTP requests responses not prohibited HTTP other circumstances referred HTTP] Section Section HTTP types proxy: transparent proxies non-transparent proxies. discussed HTTP] Section Terminology: transparent proxy proxy not modify request response required proxy authentication identification. non-transparent proxy proxy request response order provide added service user agent, such group annotation services, media type transformation, protocol reduction, anonymity filtering. transparent non-transparent behavior explicitly stated, HTTP proxy requirements apply types proxies." document elaborates behavior non-transparent proxies, used Content Transformation context discussed Landscape]. Types Transformation Transforming proxies carry wide variety operations. document categorize operations are general concepts do not formalize further): Alteration Requests Transforming proxies process requests number ways, especially replacement various request header fields avoid HTTP Status responses server not provide content compatible original HTTP request header fields) user request. Alteration Responses are classes operation responses: Restructuring content Restructuring content process original layout altered so content added removed spatial navigational relationship parts content altered, e.g. linearization reordering presentation elements, especially tables, so fit narrow display be traversed horizontal scrolling) pagination splitting document too large be stored transmitted terminal piece, so be nevertheless accessed browsing succession smaller interlinked documents). also rewriting URIs so subsequent requests are routed proxy handling response. Recoding content Recoding content process layout content remains same, details encoding be altered. Examples include re-encoding HTML XHTML, correcting invalid markup HTML, conversion images formats not, example, reducing animations static images). Optimizing content Optimizing content removing redundant white space, re-compressing images loss fidelity) compressing transfer. User Interaction various points document there reference user", user" general making user aware situation interacting user solicit choice options. expectation such user interaction conducted way user perceive interact such information choices same way interact Web sites are visiting. Conformance Classes Product Content Transformation Guidelines specification class products: Transformation Deployment Transformation Deployment provision non-transparent components path HTTP requests responses. Provisions are applicable Transformation Deployment are identified document use term proxy" singular plural. Normative Informative Parts Normative parts document are identified use following section name. Informative parts are identified use following section name. Normative Language Conformance Requirements key words not, required, not, not, recommended, not recommended, optional Recommendation have meaning defined Transformation Deployment Conformance Transformation Deployment guidelines statements Transformation Deployment Conformance, Proxy Forwarding Request, Proxy Forwarding Response User Agent Testing Transformation Deployment wishes claim conformance make available conformance statement B Conformance Statement reasons non-compliance clauses containing key words not", recommended". Conformance statements be sent public-content-transformation-conformance@w3.org. Public archive list be found http://lists.w3.org/Archives/Public/public-content-transformation-conformance/. Behavior Components Proxy Forwarding Request Applicable HTTP Methods User agents sometimes issue HTTP HEAD requests order determine resource type size are capable handling. transforming proxy convert HEAD request GET request order determine characteristics transformed response return user agent subsequently issued GET request same resource). HTTP method altered HEAD GET, proxies such action accordance normal HTTP caching rules) cache response so second GET request same content not required also Serving Cached Responses). Other convert HEAD GET proxies not alter request methods. no-transform directive Request request Cache-Control: no-transform directive, proxies not alter request other comply transparent HTTP behavior defined HTTP] sections section section add header fields described Additional HTTP Header Fields Note: example use Cache-Control: no-transform issuing asynchronous HTTP requests, perhaps means XMLHttpRequest include such directive order prevent transformation request response. Treatment Requesters are not Web browsers altering aspects HTTP requests responses proxies need take account fact HTTP used transport mechanism many applications other Browsing". Increasingly browser based applications involve exchanges data using XMLHttpRequest Proxy Decision Transform) alteration such exchanges likely cause misoperation. Serving Cached Responses Aside usual caching procedures defined HTTP], circumstances, proxies paginate responses case request be subsequent page previously requested resource. case proxies sake consistency representation serve stale data doing so notify user case provide simple means retrieving fresh copy. Alteration HTTP Header Field Values Other modifications required HTTP] proxies not modify values header fields other User-Agent, Accept, Accept-Charset, Accept-Encoding, Accept-Language header fields not delete header fields Original Header Fields). Other comply transparent HTTP operation, proxies not modify request header fields following user be prohibited accessing content result server responding request Server Rejection HTTP Request); user specifically requested restructured desktop experience User Selection Restructured Experience); request part sequence requests comprising included resources linked resources same Web site Sequence Requests). circumstances are detailed following sections. Note: emphasized requests not be altered presence Cache-Control: no-transform described no-transform directive Request. Note: section, concept site" used server") origin servers host many different Web sites. concept site" not strictly defined, proxies use heuristics including comparisons domain name assess resources form part same site". Note: URI referred request plays part determining not alter HTTP request header field values. particular patterns mentioned Proxy Decision Transform are not material. Content Tasting complying section Alteration HTTP Header Field Values) section Receipt Vary HTTP Header Field proxies avoid making repeated requests same resource. Note: HTTP not prohibit repetition GET requests, repeated requests place unnecessary load network server. Avoiding Unacceptable" Responses proxy reissue request altered HTTP header field values previous request unaltered values resulted origin server rejecting request Server Rejection HTTP Request). proxy apply heuristics various kinds assess, advance sending unaltered header field values, request likely cause unacceptable" response. likely then alter header field values sending unaltered values advance, providing subsequently response described Receipt Vary HTTP Header Field prepared reissue request unaltered header fields, alter subsequent behavior respect Web site so unaltered header fields are sent. proxy not reissue POST request unsafe HTTP] Section User Selection Restructured Experience Proxies assume default users wish receive representation prepared Web site. Proxies offer users option choose view restructured experience even Web site offers choice user experience. user made such choice then proxies alter header field values requesting resources order reflect choice, receipt indication Web site offers alternative representations I.1.4.2 Indication Intended Presentation Media Type Representation), inform user allow select alternative representation. Proxies assess user's expressed preference restructured representation still valid Web site changes choice representations Receipt Vary HTTP Header Field). Sequence Requests requesting resources are included resources style sheets, images), proxies make request such resources same User-Agent header field request resource are referenced. purpose consistency representation, proxies request linked resources referenced using element) form part same Web site previously requested resource same header fields resource are referenced. requesting linked resources do not form part same Web site resource are linked, proxies not base choice header fields consistency presentation premise. Original Header Fields forwarding HTTP request altered HTTP header fields, addition complying rules normal HTTP operation, proxies include request additional fields form header name> values are verbatim copies corresponding unaltered header field values, so possible reconstruct original header fields. example, User-Agent header field been altered, X-Device-User-Agent header field be added value received User-Agent header field. Specifically following mapping be used: Original Replacement Ref User-Agent X-Device-User-Agent RFC2616 Section Accept X-Device-Accept RFC2616 Section Accept-Charset X-Device-Accept-Charset RFC2616 Section Accept-Encoding X-Device-Accept-Encoding RFC2616 Section Accept-Language X-Device-Accept-Language RFC2616 Section Note: X-Device- prefixed header names listed section have been provisionally registered IANA Provisional Message Header Field Names). Note: X-Device- prefix was chosen primarily basis already existing convention. noted values encoded such header fields not ultimately derive device, are merely received fields. treatment received X-Device header fields, happen there are multiple transforming proxies, undefined K Scope Future Work). Additional HTTP Header Fields Irrespective presence no-transform directive: proxies add IP address initiator request end comma separated list X-Forwarded-For HTTP header field; proxies accordance RFC include Via HTTP header field Proxy Treatment Via Header Field). Proxy Treatment Via Header Field Proxies indicate ability transform content including comment Via HTTP header field consisting URI forwarding Via header fields, proxies not alter removing comments Note: According HTTP] Section Via header field comments be removed recipient prior forwarding message". However, justification removing such comments based memory limitations early proxies. Most modern proxies do not suffer such limitations. Proxy Forwarding Response User Agent following, proxies check presence equivalent <meta http-equiv> elements HTML content, relevant HTTP header field not present. User Preferences Proxies provide means users express preferences inhibiting content transformation even content transformation been chosen user default behavior. preferences be maintained user user Web site Web site basis. Proxies solicit re-expression preferences respect server server starts indicate offers varying responses discussed Receipt Vary HTTP Header Field. Receipt Cache-Control: no-transform response Cache-Control: no-transform directive then proxies not alter other comply transparent HTTP behavior described HTTP] Section Section Use Cache-Control: no-transform Proxies use Cache-Control: no-transform inhibit transformation further proxies. Server Rejection HTTP Request Proxies treat responses HTTP Status were responses HTTP Status determined content browser not supported") equivalent response HTTP Status. Receipt Vary HTTP Header Field proxy not be carrying content tasting described Avoiding Unacceptable" Responses receiving unacceptable" response. However, makes request altered header fields circumstances, response containing Vary header field referring altered header fields then request resource again unaltered header fields. also update heuristics uses so unaltered header fields are presented first subsequent requests resource. Link Representation response HTML response <link rel="alternate" media="handheld" element user agent determined being proxy request process referenced resource, resource referenced current representation. Note: document term current representation means document reference" defined Section addition Vary HTTP header field was present response then same representation values HTTP header fields request have not been altered. WML Content content WML proxies act transparent manner. Note: not affect operation proxies are also WAP Gateways. Proxy Decision Transform absence Vary no-transform directive meta HTTP-Equiv element containing Cache-Control: no-transform) proxies not transform content matching following rules user specifically requested transformation: content HTML <link rel="alternate" media="handheld"/> reference current representation; DOCTYPE content XHTML-MP, XHTML Basic, WML iMode listed E DOCTYPEs Associated Mobile Content; Content-Type value listed C Internet Content Types associated Mobile Content. URI response redirection indicated Content-Location HTTP header field) matches pattern listed F URI Patterns Associated Mobile Web Sites; response resource referenced included resource suitable resource was handled transparently; Content-Type content values are listed D Internet Content Types associated Data Content; claim mobileOK Basic Basic Tests] conformance indicated Scheme] such claim be indicated). Other factors proxy take account: Web site note) previously shown contextually aware, even present response not indicate user agent features linearization zoom, desktop device using mobile network access) allow present content unaltered; response client side scripts misoperate resource restructured; response HTML response <link> elements specifying alternatives according presentation media type. Alteration Response Note: Other noted section nature restructuring carried out, character encoding alterations omitted inserted discussed Scope, scope document. proxy response then: add Warning Transformation Applied HTTP header field; altered content validate according appropriate published formal grammar XML be well-formed; indicate user content been transformed mobile presentation provide option view original, unmodified content. Link Rewriting Note: document URIs have Same-Origin scheme component host port subcomponents, defined match. Section URI comparison. proxy deployments have links content order user agent request referenced resources proxy. so doing, proxies make unrelated resources appear have same-origin hence there danger introducing security vulnerabilities. Note: section link rewriting) also insertion links, frame flattening other techniques issue. Note: Link rewriting always used CT Proxies are accessed origin server initially, e.g. provide mobile adapted web search navigation web pages returned search results, browser redirected CT Proxy adaptation web page. Link rewriting be used CT Proxies acting normal HTTP proxies configured transparent) browser, not be required browser requests flow CT Proxy. Proxies not rewrite links content transformation prohibited. Proxies preserve security requests domains are not same-origin respect cookies scripts. HTTPS Link Rewriting Note: clarity emphasized not possible transforming proxy transform content accessed HTTPS link breaking end-to-end security. Interception HTTPS circumstances be permissible not question, such, highly pertinent document. BPWG aware interception HTTPS many networks today. Interception HTTPS inherently problematic be unsafe. BPWG refer protocol based party consent" mechanisms, such mechanisms do not exist time writing document. practice intercepting HTTPS links strongly NOT RECOMMENDED. proxy rewrites HTTPS links, advise user security implications doing so provide option bypass communicate server directly. anything else document, proxies not rewrite HTTPS links presence Cache-Control: no-transform directive. proxy rewrites HTTPS links, replacement links have scheme https. forwarding requests originating HTTPS links proxies include Via header field discussed Proxy Treatment Via Header Field. forwarding responses servers proxies notify user invalid server certificates. Testing Operators content transformation proxies make available interface functions proxy be exercised. operations possible interface cover necessary settle outcome conformance statements listed section B. interface be reachable terminals browsing capabilities connected Web conventional Internet access environment tester's premises; accessing interface necessitate adjusting standard Web browsing configuration parameters such specifying proxy IP address port desktop browser, activating WAP setting mobile browser. Such access be granted fair, reasonable non-discriminatory conditions. particular: available worldwide, not are W3C Members; not impose further conditions restrictions use technology, intellectual property rights, other restrictions behaviour tester, include reasonable, customary terms relating operation maintenance relationship tester proxy operator such following: choice law dispute resolution, confidentiality parameters access interface, disclaimer liability. References CT Landscape Content Transformation Landscape Jo Rabin, Andrew Swainston W3C Working Group Note October http://www.w3.org/TR/2009/NOTE-ct-landscape-20091027/) RFC Key words use RFCs Indicate Requirement Levels, Request Comments: S. Bradner, March http://www.ietf.org/rfc/rfc2119.txt) RFC HTTP Hypertext Transfer Protocol HTTP/1.1 Request Comments: R. Fielding, J. Gettys, J. Mogul, H. Frystyk, L. Masinter, P. Leach, T. Berners-Lee, June http://tools.ietf.org/html/rfc2616) RFC Uniform Resource Identifier Generic Syntax, Request Comments: T. Berners-Lee, R. Fielding, L. Masinter, January http://tools.ietf.org/html/rfc3986) RFC OPES IAB Architectural Policy Considerations Open Pluggable Edge Services, Request Comments: S. Floyd, L. Daigle, January http://tools.ietf.org/html/rfc3238) Device Independence Glossary W3C Glossary Terms Device Independence, Rhys Lewis W3C Working Draft January Best Practices Mobile Web Best Practices Basic Guidelines, Jo Rabin, Charles McCathieNevile W3C Recommendation, July http://www.w3.org/TR/2008/REC-mobile-bp-20080729/) mobileOK Basic Tests W3C mobileOK Basic Tests Sean Owen, Jo Rabin W3C Recommendation, December http://www.w3.org/TR/2008/REC-mobileOK-basic10-tests-20081208/) mobileOK Scheme W3C mobileOK Scheme Jo Rabin, Phil Archer W3C Note, August http://www.w3.org/TR/2009/NOTE-mobileOK-20090825/) POWDER Resource Grouping Protocol Web Description Resources Grouping Resources, Phil Archer, Andrea Perego, Kevin Smith W3C Recommendation, September http://www.w3.org/TR/2009/REC-powder-grouping-20090901/) XHR XMLHttpRequest, Anne van Kesteren W3C Candidate Recommendation August http://www.w3.org/TR/2010/CR-XMLHttpRequest-20100803/) XML Extensible Markup Language Edition), T. Bray, J. Paoli, C. Sperberg-McQueen, E. Maler, F. Yergeau W3C Recommendation, November http://www.w3.org/TR/2008/REC-xml-20081126/) B Conformance Statement See http://www.w3.org/TR/2010/NOTE-ct-guidelines-20101026/ics C Internet Content Types associated Mobile Content list not exhaustive likely change. application/vnd.wap.xhtml+xml text/vnd.wap.wml application/vnd.wap.wmlc text/vnd.wap.wml+xml text/vnd.wap.wmlscript application/vnd.wap.wmlscriptc image/vnd.wap.wbmp application/vnd.wap.wbxml application/vnd.wap.multipart.mixed application/vnd.wap.multipart.related application/vnd.wap.multipart.alternative application/vnd.wap.multipart.form-data image/x-up-wpng image/x-up-bmp D Internet Content Types associated Data Content list not exhaustive likely change. application/json application/soap+xml application/soap+fastinfoset application/fastsoap application/fastinfoset E DOCTYPEs Associated Mobile Content list not exhaustive likely change. XHTML Mobile XHTML Mobile XHTML Mobile XHTML Basic XHTML Basic XHTML XHTML Mobile group XHTML i-XHTML group XHTML i-XHTML group XHTML i-XHTML group XHTML i-XHTML group XHTML i-XHTML group XHTML i-XHTML Compact HTML Draft//EN Compact HTML WML WML WML WML WML WML WML F URI Patterns Associated Mobile Web Sites Using notation defined Resource Grouping]: <iriset> <includehosts>mobi</includehosts> </iriset> G Summary User Preference Handling User expression preferences referred several sections document. sections are: Priority Intention Serving Cached Responses User Selection Restructured Experience User Preferences Receipt Cache-Control: no-transform Proxy Decision Transform Alteration Response HTTPS Link Rewriting User preferences are also referred non-normatively I.1.4 Varying Representations. H Example Transformation Interactions Note: following examples refer requests GET method. H.1 Basic Content Tasting Proxy Request resource original header fields response response: response Cache-Control: no-transform, forward Otherwise request again altered header fields response response: response Vary: User-Agent, appropriate link element header field, Cache-Control: no-transform, forward Otherwise assess response form Unacceptable" not, forward request again altered header fields H.2 Optimization based Previous Server Interaction Proxy request resource P not encountered Proxy forwards request Response containing text browser. get different use CT proxy." Proxy Status requests resource origin server again altered header fields well known desktop browser) Response desktop oriented representation resource Proxy response content user agent display well forwards Proxy further request resource P Based evidence previous interaction there was Vary header field, response was not targeted only previous user there was Cache-Control: private directive) CT proxy forwards request altered header fields Response desktop oriented representation resource Proxy response content user agent display well forwards H.3 Optimization based Previous Server Interaction, Server Changed Operation Proxy request resource P, previously encountered H.2 Optimization based Previous Server Interaction Proxy forwards request altered header fields Response containing Vary: User-Agent header field Proxy notices behavior changed reissues request original header fields Response proxy forwards H.4 Server Response Indicating Representation Intended Target Device Proxy request resource P Proxy forwards request original header fields Response Vary: User-Agent <link type="alternate" media="handheld" href="P#id" id document local reference Proxy forwards response designed specifically requesting device H.5 Server Response Indicating Representation Intended Target Device Proxy request resource P Proxy forwards request original header fields Response <link type="alternate" media="handheld" href="Q" Q not P Proxy requests Q original header fields Response proxy forwards Informative Guidance Origin Servers Content providers wish follow procedures order improve interoperability. I.1 Server Response Proxy I.1.1 Use HTTP Status Servers consider using HTTP Status not HTTP Status) request be satisfied content criteria specified values HTTP request header fields. However, browsers do not display content HTTP Status responses. I.1.2 Use HTTP Status Servers consider using HTTP Status concerned security link assumed be private been compromised example be inferred presence Via HTTP header field HTTPS request). I.1.3 Server Origination Cache-Control: no-transform Servers consider including Cache-Control: no-transform directive received HTTP request, be indication client not wish receive transformed response. Include Cache-Control: no-transform directive reason, transformation response prohibited. Note: Including Cache-Control: no-transform directive disrupt behavior WAP Gateways, inhibit such proxies converting WML WMLC. Including such directive also disrupt behavior proxy based accessibility solution. I.1.4 Varying Representations good practice take account user agent capabilities formulate appropriate experience according capabilities. good practice provide means users select available representations, default last selected representation provide means changing selection. I.1.4.1 Use Vary HTTP Header Field server representation according examination received HTTP header fields then HTTP] use Vary header field indicate Servers are aware presence transforming proxy, identified Via HTTP Header field alter responses according knowledge specific proxy behavior. doing so good practice make sure Internet content type response correct actual content server not choose Content-Type: application/vnd.wap.xhtml+xml suspects proxies not transform content type, content not valid XHTML-MP). I.1.4.2 Indication Intended Presentation Media Type Representation server distinct representations vary according target presentation media type, inhibit transformation response including Cache-Control: no-transform directive I.1.3 Server Origination Cache-Control: no-transform). addition, HTML content indicate medium representation intended including link element identifying media attribute target presentation media types representation setting href attribute Reference" section particular empty href attribute Document Reference". addition good practice include link elements identifying target presentation media types other available representations similar manner. content more presentation media type served same URI, better not use link element identifying presentation media types URI appear be document reference", indicating client representation suitable named presentation media types. Instead, use Vary HTTP header field indicating response according received User-Agent HTTP header field. Note: examples use link element are included H Example Transformation Interactions. J Applicability Transforming Solutions are Scope are number well-known examples solutions seem users are using browser, client software using proprietary protocols techniques, combination client network component regarded HTTP User Agent. communication client network component therefore scope document. Additionally, kind administrative arrangement transforming proxy origin server purposes transforming content origin server's behalf, also scope document. cases, good practice adhere provisions document respect providing information device original IP address. K Scope Future Work K.1 POWDER BPWG POWDER represent powerful mechanism server express transformation preferences. Future work area recommend use POWDER provide mechanism origin servers indicate more precisely alternatives have transformation are willing allow addition provide Content Transformation proxies indicate services are able perform. K.2 link HTTP Header Field BPWG link HTTP header field was removed HTTP/1.1, discussion reintroduction, represent more general flexible mechanism use HTML link element, discussed recommendation. K.3 Sources Device Information process adapting content origin server, transforming proxy likely have dependency repository device descriptions. origin server's willingness allow transforming proxy transform content depend evaluation trustworthiness device description data being used. scope enhancement trust relationship means indicating K.4 Inter Proxy Communication scope further work define multiple proxies interoperate. common case multiple proxies network provider transforming proxy search engine transforming proxy are present. K.5 Explicit Consent Robust mechanisms are needed indicating consent prohibition transformation operations various kinds, especially HTTPS link rewriting HTTPS Link Rewriting). K.6 Amendment Refinement HTTP BPWG amendments HTTP are needed improve interoperability transforming proxies. example, HTTP not provide way distinguish prohibition kind transformation prohibition only restructuring not recoding compression). present HTTP not provide mechanism communicating original header field values. scheme based X-Device prefixed fields described Alteration HTTP Header Field Values records approach used achieve effect content transformation proxies. scheme non-standard HTTP header fields have been provisionally registered IANA. mechanism defined section, based current practice, conforming transformation proxy deployments, possible future, collaboration IETF, approach be reconsidered. specified X-Device prefixed fields time, become deprecated favor new equivalent fields, entirely different approach be taken representing such values. number mechanisms exist HTTP be exploited given more precise definition operation example OPTIONS method HTTP Choices) Status. L Acknowledgments editor contributions various kinds members Mobile Web Best Practices Working Group earlier Content Transformation Task Force group. editor significant written contributions FranÃ§ois Daoust Force Leader), W3C Magnus LÃ¶nnroth, Ericsson previously Drutt) Bryan Sullivan, AT&T Sean Patterson, Novarra Aaron Kemp, Google Rob Finean, Openwave Heiko Gerlach, Vodafone Martin Jones, Volantis Tom Hume, W3C Invited Expert Eduardo Casais, W3C Invited Expert 