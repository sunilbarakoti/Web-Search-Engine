Component Extension API requirements Version Component Extension API requirements Version W3C Note December version: http://www.w3.org/TR/2001/NOTE-CX-20011211 Latest version: http://www.w3.org/TR/CX Editors: Angel Diaz, IBM Jon Ferraiolo, Adobe Stein Kulseth, Opera Philippe Le Hégaret, W3C Chris Lilley, W3C Charles McCathieNevile, W3C Tapas Roy, Openwave Ray Whitmer, Netscape/AOL Copyright©2001 W3C® INRIA, Keio), Rights Reserved. W3C liability,trademark,documentuse, softwarelicensing rules apply. Abstract early days World Wide Web, Web Agents had been extended tosupport more types contents. recent developments XML thepossibility mix mupltiple XML Namespaces document reiterated theneed extend implementations relaying add-on softwares accomplishtasks not supported default implementation. other words, haveseveral XML languages represent different parts Web pages SVG,MathML, XForms, etc.), now need well defined mechanism allowdifferent specialized tools work together handled compounddocuments. W3C Note non-exhaustive list requirements work aComponent Extension API. goal API extend ability Web application.Note Web application be server side clientside, not automatically interaction user having aWeb browser. Status Document document early draft resulting HyperText CoordinationGroup face face meeting discuss standardization Plug-in ActiveComponent Architecture Web. anticipated bepublished W3C note soon reached appropriate state ofmaturity. document Notemade available W3C discussion only. Publication Note byW3C endorsement W3C W3C Team, W3C Members.There commitment W3C invest additional resources topicsaddressed Note. Comments document are invited are be sent publicmailing list www-component-extension@w3.org.An archive available http://lists.w3.org/Archives/Public/www-component-extension/. W3C Technical reports are publishedonline http://www.w3.org/TR. Table Contents Requirements Formatting baseline linehight linebreak, size rectangle negotiation, multiplerectangles DOMViews Formatting Rendering freeze/unfreeze z-order/painting sharingcolormap sharingfonts colors(accessibility issues) Devicedependent drawing forcingredraws, invalidate rectangles, invalidate region window-less plug-in Style DOMCSS values values actual values Generic Styler Local Styler Mobile profiles Error handling Events DOM Core tree Starting point Connecting withoutside/scripting Nesting/reetrance Abstraction level timeline network/HTTP Editing Editing mode associations/registrations/negociations Accessibility Versioning storage/persistence Memory management Security Appendices Glossary B References C Contributors Requirements document description Component Extension requirements established CG meeting August Application Programming Interface requirements 3categories: requirement be addressed Component Extension API. requirement be addressed Component Extension API. requirement declared scope Component Extension API. become scope future versions. description Component Extension be terms content handled, not terms specific piece software. example, isappropriate request Component Extension SVG including set functionalities identified using SMIL required functionalities mechanism theswitch element, SVG equivalent). list requirements provided document not exhaustive andonly requirements HyperText CG meeting. Formatting Host implementation provide amechanism embedded object request region set regions fordisplaying content. formatting interface be independent ofplatform specific constraints. baseline andlinehight Host implementation Component Extension need coordinate thelinehight baseline. linebreak,size rectangle negotiation, multiple rectangles Host provide means determine maximum size therectangle embedded object render. Conceptually, sizeof page be unconstrained dimensions given scrolling. Inpractice, Host somehow constrain least dimension. example, Host indicate rectangle scrollable inthe line-stacking direction. fix other dimension. Typically, itwould report current width renderable area. embedded object be permitted negotiate rectangles breakinto smaller areas lines need be. DOM Views andFormatting Level Views Formatting] beconsidered Component Extension API. Rendering freeze/unfreeze[1] Component Extension wish suspendrendering momentarily example succession changes are made tothe structure, structure made temporarily invalid, someother reason intermediate state document bedisplayed. Examples such methods: SVG DOM: SVGSVGelement unsigned long suspendRedraw(in unsigned long max_wait_milliseconds); void unsuspendRedraw(in unsigned long suspend_handle_id) void unsuspendRedrawAll(); void forceRedraw(); void pauseAnimations(); void unpauseAnimations(); See also section Openwave plugin API PluginSuspend PluginResume methods. z-order/painting[1] be possible content rendered Component Extensions take correct place z-orderof entire document be other content such backgrounds,which show transparent areas, other content later documentor higher z-order be able partially overlap content renderedby Component Extension. clipping Clipping, addresses removal parts display elements thatlie given boundary, be addrssed ComponentExtension. sharing colormap[2] Implementations require colormap need allow Component Extension request allocation ofcolors colormap find colors are already thecolormap, be notified color associated particular colorindex changed. sharing fonts[2] Component Extension have access tosystem fonts properties. Host implementation provide means forquerying metrics current font. Metrics interest be subsetof provided Hostimplementation provide methods determining glyph bounding boxes,baselines, nominal font height. also provide indicationwhether given character maps glyph font. Component Extension be able find aboutdownloadable fonts other content same page made available,and make available fonts downloaded. fontproperties use parent element content beingrendered Component Extension be madeavailable inheritance ComponentExtension interface so same fonts be used Component Extension. Accessibility information preferred font sizes be passedacross Component Extension interface. colors(accessibility issues) Device dependentdrawing Component Extension API provide aplatform dependent XWindow Graphic Context, Microsoft Device Context)method gathering device dependent information formatting drawinginto rectangles optimisation drawing, such aswindow, device context, fonts). However not preclude ability touse device independent methods, specification recommend thatthese are available fallback. forcing redraws,invalidate rectangles, invalidate region Component Extension-does-compositing model direct screendrawing, Component Extension damagecontent rendered something else. situation windowingsystems window iconised other windows arenow uncovered have be told redraw. container-does-compositing model, rendering being offscreenRGBA pixmap, not have problem need not tell parents orother Component Extensions redraw. Moving orupdate Component Extension merely requiresre-composition current stack offscreens need aforced redraw, be limited particular invalidatedregion. Issue descriptions narrowly miss actually listing requirement. Make itsimpler. See also Plug-ins]. window-less plug-in[1] Component Extension do not draw allshould be addressed Component ExtensionAPI. See also Plug-ins]. Style DOM CSS section relation Component Extension API Document Object Model CSS specification Level Style Sheets andCSS]. specified values[3] DOM Level CSS specification Level 2Style Sheets CSS], note not require access specifiedCSS values style sheets. computedvalues Host implementation DOMtree Component Extension CSS Style engine, Component Extension API have access computed CSSvalues nearest DOM Node ancestor parentNode) using DOM Level2 CSS Level Style Sheets CSS] ViewCSSinterface. Depending CSS Style engine, Host Implementation mayalso provide fully decorated DOM tree content addressed Component Extension. actualvalues Actual CSS values, defined CSS specification Level not be addressed Component Extension API. Styler Host implementation contain engine handle general properties provide extension mechanismin order support other properties. Generic Styler engine theresponsibility decorating DOM tree computed values also1.3.1.2 computed values). Languages, such CSS, have mechanism extend set styleproperties used application. example, SVG reused properties listed CSS 2specification Level new ones. isexpected Generic Styler Hostimplementation supports specific set properties generalstyle properties such color, background fonts are required besupported. foreign style property styleproperty not recognized internally Generic Styler.] TheGeneric Styler not know default value, value beinherited not. Generic Styler expected support foreign styleproperties. Component Extension declareinformation style properties uses be foreign GenericStyler such parse, default values, inheritance, Styler isresponsible maintaining information dealing duplicatedeclarations Component Extensions. Component Extension remove styleproperties values associated style properties. other words,the set style properties stored Generic Styler union style properties supported Hostimplementation Component Extensions.If computed value not recognized, Generic Styler use default value colors, always make computed value have parts value first set values possible extended value have extended value callback Issue do style sheets not known ComponentExtension be loaded? LocalStyler Component Extension also embedded itsown local Style engine. case, Component Extension not needto declare get computed values style properties DOM tree.This model advantage not assume DOM API Host implementation ComponentExtension, only root node Component Extension local Style engine needs provide: access style sheets. access containing DOM tree access information item order get computed values style properties: propname value access style properties information: propname inherit/initial value. Mobile profiles Mobile profiles are always required be supported Hostimplementation Component Extensions. Error handling[2] error handling mechanism be provided Host implementationto Component Extension future revision ofthe Component Extension API. mechanism bebased inspired error handling mechanism provided DOMLevel Core specification Level Core]. Events be way pass events Hostimplementation Component Extension andfrom Component Extension Hostimplementation. Host implementationprovides DOM tree component extension eventmechanism, Component Extension API support DOM Level Eventsspecification. User Interface events, such window events system events(reload, URI notify events), be addressed. Namespace-bound events are events propagation limited elementsnamespace boundaries, i.e. reaches element doesnot use ancestor's namespace name. Namespace bound events are ofscope. DOM Core tree[1] Component Extension API provideprogrammatic read-only access HTML XML content conforming thefollowing modules W3C Document Object Model Level Core Specification[DOM Level Core] exporting interfaces theydefine: Core module HTML Core XML modules XML. Starting point[1] Features existing Netscape Plugin API Plug-ins] considered startingpoint implementation experience features Component Extension API, be modified, replaced, oreliminated required address problems requirements. outside/scripting Component Extension call Host implementation function request connection oneof features. feature be generic functionality whetherthis selected button, menu item, keyboard shortcut, drag-drop, specific Host implementation chrome toolbar, button, status bar request be output data feature status bar,title bar, alert, subscribe events generated browsercontrol, add control chrome toolbar, menubar, menu...) Host implementation return valueindicating connection not. Component Extension API define howthe features are selected, specify minimal list connections thebrowser allow have requested feature, so Component Extension reasonably expect such aconnection request be granted. Subscribed-to events be passed ComponentExtension using normal event-passing mechanism Events). connection needs pass largeamounts data, Component Extension's streamAPIs be used. chrome adding new items/removing new items drop down menu"/main menu bar status line copy/paste find drag/drop focus alert query user agents capabilities? cross plug-in streams properties properties dialog system properties: hostname, IP, be possible Component Extensionto discover, available, integrate formatting rendering ofexternally supported content types inserted Component Extension DOM Node's subhierarchy are notinternally supported ComponentExtension. level Much W3C DOM IDL descriptions language bindings, theComponent Extension API be described independent programminglanguage, operating system platform. timeline[2] SMIL specification forsynchronized multimedia SMIL Animation specification timing animation aspects ofSMIL be integrated other languages, such SVG chapter 19in Host implementation supportssynchronized playing media such audio, video animations, then implementation support ability time-based Component Extensions play media portion Hostcanvas, Host-played media Component Extension-played mediamust be synchronized. API achieving synchronization be richenough permit accurate implementation attributes defined section SMIL SMIL Animation allow content be started stopped viainteractivity, such User Interface events mouse keyboard). Host-supplied event propagation APIs be such time-based Component Extensions implement interactivitycapabilities defined section time support", Host implementation supports streamingmedia, then Host implementation supplyAPIs allow Component Extensions receivestreaming content. network/HTTP[1] Networking Support include API request data URIreference. Component Extension call Host implementation function pass URI reference, anyadditional headers example, case HTTP, maybe additionalaccept type), method case HTTP, GET, PUT, POST HEAD) apointer notify data. Component Extensionmay tell Host implementation use thecache override request complete, Hostimplementation call ComponentExtension's notify function, pass data Component Extension using ComponentExtension's stream APIs. Example: kError HostURIRequest(kURIMethod method, const char const char const char unsigned long entitySize, void* notifyData, boolean useCache); void CXURINotify(const char kStatus status, void* notifyData); Issue(networking-1): Netscape model Plug-ins], corresponding network request are sent Component Extension Hostimplementation creating stream: callback mechanism. reused mechanism do want tie asynchronousrequests DOM) event model Editing Many Component Extensions involve editingfunctions, so API provide method access editingfunctionalities character input, drawing interfaces, etc. beavailable device independent manner. requirement also means available rendering space need be dynamically re-sized also1.1.2 linebreak, size rectangle negotiation,multiple rectangles). Editing mode[1] Component Extension API provide interface thenotification toggle modes. API bepresent Host implementation Component Extension. order Component Extension be extend Host DOM implementation, there be way Component Extension register own DOMimplementation Host DOM implementation. case, DOMimplementation Node factories Document create DOM Nodes using theregistered Component Extensions Node thecorresponding types. Only construction DOM nodes affected bythe registrations, not building DOM tree. Component Extension not provide DOM implementation, implementation build entire DOMtree including content addressed Component Extension. Host implementation supportfor XML documents, also implement thenamespaces support defined Namespaces recommendation Namespaces]. Namespace conflicts resolutionbetween Component Extensions be resolved bythe Host implementation. be way forthe user choose Component Extensionimplementations case conflicts. set functionalities provided Hostimplementation be accessible Component Extension. sameapplies Component Extension: Host implementation have way query set offunctionalities provided ComponentExtension. are severals ways extend Host implementation. Technologiessuch XBL IE behaviors be considered. group decide come up modular architecture XMLparser permit XML content be handled othercomponent. general stream API be addressed ComponentExtension gain access data. Component Extension API provide foraccessibility requirements. Substantially, need forseveral requirements listed already, such ability specify acontent-type rather plugin, provision use ofdevice-independent interaction interfaces. User Agent Accessibility Guidelines requirethat access provided DOM interfaces, example MSAA, Java Accessibility API, etc) theyexist. Component Extension API have anidentifiable versioning mechanism. version information change eachtime functionality changed. am not sure necessary discuss techniques here, done inthe following paragraph. technique achieving provide naming forfunctionalities, use mechanism CC/PP identifying availablefunctionalities. little heavy purpose, andseems be better suited using various unstandardized systems rather standardized system. Host implementation allow Component Extension data persistentstorage file system. ability be governed security modelassociated Component Extension. example, web page ability store cookies filesystem host. sandbox model there. Furthermore, usermay block web pages setting cookies. storage functionality be divided Reading Writing data specific Component Extension. Storage) Example, saving high scores game. Storing cookies example context web page. Reading Writing data global data. Storage). Example, reading list addresses specific address) addressbook. first item, Host implementationmay provide Component Extension APIs getand set values. example, set: HostSetAttribute("newscore", itoa(newScore)); read, length = HostGetDataSize > scoreString = memAlloc HostGetAttribute scoreString);} security settings ComponentExtension do not allow operations, then operations fail.Or, user maybe prompted advice. See also Persistent Storage]. Memory management[1] Memory management include APIs Allocating block memory Resizing block memory Releasing block memory Flushing memory host's space. Issue(memory-1): much memory plugin be allowed Probable answer: Systemdependent. allocation function exception begenerated. Issue(memory-2): read/write? allocate APIs return pointer, APIs do), prevent plugin do something char* s = MemAlloc s[2000] = system have memory management unit, freezethe system. Security Security issues be considered functionalities theComponent Extension API. Glossary Component Extension term Component Extension well-known plug-ins Web browsers) software charge providing client-side part Component Extension API. program runs part Host implementation not part content. Host implementation term Host implementation software charge providing server-side part Component Extension API. Softwares include Web browsers, media players, Component Extensions, other programs assistive technologies) help retrieving processing rendering) Web content. Application Programming Interface application programming interface communication take place applications. set functions methods used access functionality. B References CSS Level W3C Wide Web Consortium) Cascading Style Sheets, level Specification, May Available http://www.w3.org/TR/1998/REC-CSS2-19980512 DOM Level Core W3C Wide Web Consortium) Document Object Model Level Core Specification, November Available http://www.w3.org/TR/2000/REC-DOM-Level-2-Core-20001113 DOM Level Core W3C Wide Web Consortium) Document Object Model Level Core Specification, September Available http://www.w3.org/TR/DOM-Level-3-Core DOM Level Style Sheets CSS W3C Wide Web Consortium) Document Object Model Level Views Formatting Specification, November Available http://www.w3.org/TR/2000/REC-DOM-Level-2-Style-20001113 DOM Level Views Formatting W3C Wide Web Consortium) Document Object Model Level Views Formatting, November Available http://www.w3.org/TR/2000/WD-DOM-Level-3-Views-20001115 Netscape Plug-ins Netscape Plug-in Guide, Available http://developer.netscape.com/docs/manuals/communicator/plugin/index.htm OpenType Microsoft OpenType Specification, April Available http://www.microsoft.com/typography/otspec/default.htm RFC2396 IETF Engineering Task Force) RFC Uniform Resource Identifiers Generic Syntax, eds. T. Berners-Lee, R. Fielding, L. Masinter. August Available http://www.ietf.org/rfc/rfc2396.txt SVG W3C Wide Web Consortium) Scalable Vector Graphics Specification, September Available http://www.w3.org/TR/SVG SMIL W3C Wide Web Consortium) Synchronized Multimedia Integration Language August Available http://www.w3.org/TR/smil20 SMIL Animation W3C Wide Web Consortium) SMIL Animation, September Available http://www.w3.org/TR/smil-animation User Agent Accessibility Guidelines W3C Wide Web Consortium) User Agent Accessibility Guidelines September Available http://www.w3.org/TR/UAAG10 WAP Persistent Storage WAP Forum Application Forum) WAP Persistent Storage Interface May Available http://www1.wapforum.org/tech/documents/WAP-227-PSTOR-20010530-a.pdf XML W3C Wide Web Consortium) Extensible Markup Language October Available http://www.w3.org/TR/2000/REC-xml-20001006 XML Information set W3C Wide Web Consortium) XML Information Set, August Available http://www.w3.org/TR/2001/PR-xml-infoset-20010810 XML Namespaces W3C Wide Web Consortium) Namespaces XML, January Available http://www.w3.org/TR/1999/REC-xml-names-19990114 C Contributors people contributed document are members Coordination Group participants Oslo face-to-facemeeting: Jonny Axelsson Bert Bos Angel Diaz Jon Ferraiolo(Adobe), Max Froumentin Rick Graham Stein Kulseth Jackson Philippe Le Hégaret Håkon Lie(Opera), Rune Lillesveen Chris Lilley, Charles McCathieNevile(W3C), Steven Pemberton Vincent Quint HyperText CG Chair),Tapas Roy Peter Stark Ray Whitmer Zilles 