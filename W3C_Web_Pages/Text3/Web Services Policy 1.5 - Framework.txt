Web Services Policy Framework Web Services Policy W3C Recommendation04 September version: http://www.w3.org/TR/2007/REC-ws-policy-20070904 Latest version: http://www.w3.org/TR/ws-policy Previous version: http://www.w3.org/TR/2007/PR-ws-policy-20070706/ Editors: Asir S Vedamuthu, Microsoft Corporation David Orchard, BEA Systems, Inc. Frederick Hirsch, Nokia Maryann Hondo, IBM Corporation Prasad Yendluri, webMethods subsidiary Software AG) Toufic Boubez, Layer Technologies Ümit Yalçinalp, SAP AG. refer erratafor document, include normativecorrections. See also translations. document also available non-normative formats:PDF, PostScript, XML, plain text. Copyright © ERCIM,Keio), Rights Reserved.W3C liability,trademarkand documentuse rules apply. Abstract Web Services Policy Framework generalpurpose model corresponding syntax describe policies ofentities Web services-based system. Web Services Policy Framework base set constructsthat be used extended other Web services specificationsto describe broad range service requirements andcapabilities. Status Document section status document thetime publication. Other documents supersede thisdocument. list current W3C publications latestrevision technical report be found W3C technical reports index athttp://www.w3.org/TR/. W3CRecommendation Web Services Policy Frameworkspecification. been produced Web Services Policy WorkingGroup, part W3C Web ServicesActivity. document been reviewed W3C Members, softwaredevelopers, other W3C groups interested parties, isendorsed Director W3C Recommendation. stabledocument be used reference material cited fromanother document. W3C's role making Recommendation todraw attention specification promote widespreaddeployment. functionality interoperability ofthe Web. Working Group released test suite implementation report. diff-marked version againstthe previous version document available. Working Group tracking comments Bugzilla highly receive comments thissystem. access Bugzilla not feasible, send yourcomments mailing list public-ws-policy-comments@w3.orgmailing list Bugzilla entry email message containonly comment. comments specification be madefollowing Description forIssues Working Group. document was produced group operating the5February W3C Patent Policy. W3C public list anypatent disclosures made connection deliverables ofthe group; page also instructions disclosing apatent. individual actual knowledge patent whichthe individual Essential Claim(s) disclose information accordancewith section W3C Patent Policy. Table Contents Introduction Example Notations andTerminology Notational Conventions Extensibility XMLNamespaces Terminology Policy Model PolicyAssertion PolicyAlternative Policy Policies ofEntities Web Services Based System Policy Expression Normal Form PolicyExpression PolicyIdentification Compact Policy Expression Optional Policy Assertions Policy Assertion Nesting Policy Operators Policy References Policy Inclusion Normalization Ignorable PolicyAssertions PolicyIntersection Useof IRIs Policy Expressions SecurityConsiderations Information DisclosureThreats Spoofing TamperingThreats DowngradeThreats Repudiation Threats Denial Service Threats General XML Considerations Conformance Appendices A. Theapplication/wspolicy+xml Media Type A.1 Registration B. References B.1 Normative References B.2 OtherReferences C. Acknowledgements(Non-Normative) Introduction Web Services Policy Framework framework expressing policies refer domain-specificcapabilities, requirements, general characteristics entitiesin Web services-based system. policy collection ofpolicy alternatives. policy alternative collection ofpolicy assertions. policy assertion requirement,capability, other property behavior. policy expressionis XML Infoset representation policy, normalform equivalent compact form. policy assertionsspecify traditional requirements capabilities willmanifest messages exchanged(e.g., authenticationscheme, transport protocol selection). Other policy assertions haveno wire manifestation messages exchanged, yet are relevantto service selection usage privacy policy, QoScharacteristics). Web Services Policy Framework asingle policy language allow kinds assertions beexpressed evaluated consistent manner. Web Services Policy Framework not cover discovery ofpolicy, policy scopes subjects, respective attachmentmechanisms. policy attachment mechanism forassociating policy more policy scopes. policy scope acollection policy subjects policy Apolicy subjectis entity endpoint, message, resource, interaction)with policy be associated. Web Services Policy ServicesPolicy Attachment] such policy attachmentmechanisms, especially associating policy arbitrary XMLelements WSDLartifacts Core Language], andUDDI elements API Data Structure2.0, UDDI Otherspecifications are free define extensions themechanisms defined Web Services Policy Attachment[Web Services PolicyAttachment], additional mechanisms not covered WebServices Policy Attachment Services Policy Attachment],for purposes associating policy policy scopes andsubjects. Example Example 1-1illustrates security policy expression using assertions definedin WS-SecurityPolicy Example Web Services Policy security policy assertions. <wsp:Policy xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:wsp="http://www.w3.org/ns/ws-policy" >(02) <wsp:ExactlyOne>(03) <wsp:All>(04) <sp:SignedParts>(05) <sp:Body/>(06) </sp:SignedParts>(07) </wsp:All>(08) <wsp:All>(09) <sp:EncryptedParts>(10) <sp:Body/>(11) </sp:EncryptedParts>(12) </wsp:All>(13) </wsp:ExactlyOne>(14) </wsp:Policy> Lines represent policy alternative signing amessage body. Lines represent second policy alternative forencrypting message body. Lines illustrate ExactlyOne policyoperator. Policy operators group policy assertions policyalternatives. valid interpretation policy bethat invocation Web service sign encrypt themessage body. Terminology section notations, namespaces, andterminology used specification. Notational Conventions specification uses following syntax normativeoutlines: syntax XML instance, values initalics indicate data types instead literal values. Characters are appended elements attributes indicatecardinality: more) more) character used indicate exclusive choicebetween alternatives. characters are used indicate containeditems are be treated group respect cardinality orchoice. document XML Information Set Information Set]. Information itemproperties are indicated style XML namespace prefixes Table used indicate namespace element attributebeing defined. ellipses characters are used indicate point ofextensibility other Element Attribute InformationItems. Elements Attributes defined specification arereferred text document using XPath expressions. Extensibility points are referred using anextended version syntax: element extensibility point referred using inplace element name. element name canbe used, namespace, specified otherwise such inSection PolicyOperators. attribute extensibility point referred using inplace attribute name. attribute namecan be used, namespace. Normative text specification precedence overnormative turn take precedence XMLSchema SchemaStructures] descriptions. normative specification, ellipses(i.e., indicate point extensibility otherElement Attribute Information Items. Information ItemsMAY be added indicatedextension points MUST NOTcontradict semantics element information item indicatedby extension. context, AttributeInformation Item not recognized, be ignored. Element Information Itemis not recognized, MUST be treatedas policy assertion, specified otherwise such inSection PolicyReferences. XMLNamespaces specification uses number namespace prefixesthroughout; are listed Table choice namespace prefix arbitrary notsemantically significant Table Prefixes Namespaces used thisspecification Prefix Namespace Specification sp http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702 wsam http://www.w3.org/2007/05/addressing/metadata Metadata] wsp http://www.w3.org/ns/ws-policy specification wsu http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd xs http://www.w3.org/2001/XMLSchema Structures] information items defined specification areidentified XML namespace URI http://www.w3.org/ns/ws-policy.A normative XMLSchema SchemaStructures, XML SchemaDatatypes] document be obtained indirectly bydereferencing namespace document WS-Policy namespaceURI. intent W3C Web Services Policy Working Groupthat Web Services Policy Framework Web ServicesPolicy Attachment XML namespace URI not changearbitrarily subsequent revision corresponding XMLSchema documents specifications transition CandidateRecommendation, Proposed Recommendation Recommendation status.However, specifications revert Working Draft status,and subsequent revision, published WD, CR PR draft,results non-backwardly compatible changes previouslypublished WD, CR PR draft specification, namespaceURI be changed accordingly. policy, following are examples backwardscompatible changes not result assignment new XMLnamespace URI: Addition new global element, attribute, complexType andsimpleType definitions. Addition new elements attributes locations covered apreviously specified wildcard. Modifications pattern facet type definition forwhich value-space previous definition remains valid orfor value-space vast majority instances wouldremain valid. Modifications cardinality elements modificationsto minOccurs maxOccurs attribute value elementdeclaration) value-space possible instancedocuments conformant previous revision schema wouldstill be valid revised cardinality rule. Terminology keywords NOT", NOT", document are be interpretedas described RFC RFC2119]. introduce following terms are used thisdocument: collection items collection specification areunordered contain duplicates. ignorablepolicy assertion ignorable policy assertion assertion beignored purposes determining compatibility ofalternatives policy intersection lax mode defined in4.5Policy Intersection). nested policyexpression nested policy expression policy expressionthat Element Information Item property policyassertion. policy policy potentially empty collection policyalternatives. policyalternative policy alternative potentially empty collection policyassertions. policyassertion policy assertion requirement, acapability, other property behavior. policyassertion parameter policy assertion parameter behaviorindicated policy assertion. policy assertiontype policy assertion type class policy assertionsand schema assertion assertion-specificsemantics. policyattachment policy attachment mechanism associatingpolicy morepolicy scopes. policyexpression policy expression XML Infoset representation apolicy, normalform equivalent compact form. policy scope policy scope collection policy subjects towhich policy apply. policy subject policy subject entity endpoint,message, resource, operation) policy be associated. PolicyModel section abstract model policies foroperations policies. descriptions use XML Infoset terminology forconvenience description. However, abstract model isindependent represented XML Infoset. Assertion policy assertionrepresents requirement, capability, other property abehavior.] policy assertion behavior requirement capability policy subject. policysubject entity endpoint, message, resource,operation) policycan be associated. Assertions indicate domain-specific transactions) semantics are expected be defined inseparate, domain-specific specifications. assertion MAY indicate ignorable policyassertion Policy Assertions). ignorable policyassertion assertion be ignored purposes ofdetermining compatibility alternatives policyintersection lax mode defined PolicyIntersection).] default, assertion not ignorable forpolicy intersection. Assertions are typed authors define policy assertiontype class policy assertions schema forthe assertion assertion-specific semantics.] policyassertion type identified only XML Infoset[namespace name] name]properties qualified name QName) rootElement Information Item representing assertion. Assertions ofa given type MUST be consistentlyinterpreted independent policy subjects. Authors MAY define anassertion policy expression defined Policy Expression) ofits Nestedpolicy expression(s) are used authors further qualify oneor more specific aspects parent policy assertion. Thequalification indicate relationship context theparent policy assertion nested policy expression. examplewithin security domain, security policy authors define anassertion describing set security algorithms qualify thespecific behavior security binding assertion. parent policyassertion domain also serve container thenested policy expression domain. XML Infoset policy assertion MAY contain non-empty[attributes] property non-empty[children] property. Such properties, excludingthe Attribute Element Information Items WS-Policylanguage XML namespace name are policy assertion parameters andMAY be used parameterize indicated assertion. policy assertionparameter behavior indicated policy assertion.]For example, assertion identifying support specificreliable messaging mechanism include attribute informationitem indicate long endpoint wait sending anacknowledgement. Authors be cognizant processing requirements whendefining complex assertions containing policy assertion parameters ornested policy expressions.Specifically, authors are encouraged consider identityof root Element Information Item alone enough convey therequirement capability. Alternative policy alternative isa potentially empty collection policy assertions.] items acollection specification are unordered maycontain duplicates. alternative assertions indicatesno behaviors. alternative more assertions indicatesbehaviors implied only assertions. Assertions alternative are not ordered, thusaspects such order behaviors byassertions) are applied subject are scope thisspecification. However, authors write assertions controlthe order behaviors are applied. policy alternative MAY containmultiple assertions same type. Mechanisms determiningthe aggregate behavior indicated assertions theirPost-Schema-Validation Infoset XML Schema Part Schema Structures])content, are specific assertion type are outsidethe scope document. policy assertion authors did notspecify semantics repetition policy assertions type thatallows parameters nestedpolicy expressions policy alternative, then repetition issimply redundancy, multiple assertions assertiontype policy alternative have same meaningas single assertion typewithin policy alternative. Note: Depending semantics domain specific policyassertions regardless are qualified nested policyexpressions, combination policy assertions be requiredto specify particular behavior. example, combination twoor assertions WS-SecurityPolicy specification isused indicate message-level security protecting messages sp:AsymmetricBinding assertion used toindicate message-level security, sp:SignedPartsassertion used indicate parts message beprotected sp:EncryptedParts assertion usedto indicate parts message requireconfidentiality. Policy Apolicy potentially empty collection policyalternatives. policy alternatives nochoices; policy more alternatives choice inrequirements capabilities policy. Alternatives are not ordered, thus aspects such aspreferences alternatives given context are thescope specification. Alternatives policy differ significantly termsof behaviors indicate. Conversely, alternatives apolicy be very similar. case, value orsuitability alternative generally function thesemantics assertions alternative thereforebeyond scope specification. Policies ofEntities Web Services Based System Applied Web services based system, policy used convey conditions interactionbetween entities application, provider service, Webinfrastructure component, etc). interaction moremessage exchanges entities. responsibility ofassertionauthors define interaction scope assertion includingany constraints policy subjects assertion beattached clear specification message thatinteraction scope assertion entity Web services based system expose policy toconvey conditions functions. Satisfying assertionsin policy usually results behavior theseconditions. example, entities requester provider policies, requester use policy theprovider decide not use service. requesterMAY choose alternative eachis valid configuration interaction service, arequester MUST choose only singlealternative interaction service representsan alternative configuration. policyassertion supported entity web services basedsystem only entity satisfies requirement capability) corresponding assertion. Apolicyalternative supported entity only entitysupports assertions alternative. policy supported entity andonly entity supports least alternatives thepolicy. Note policy alternatives are meant bemutually exclusive, be decided general notmore alternative be supported same time. Note entity be able support policy even theentity not understand type assertion thepolicy; entity only understand type eachassertion policy alternative entity supports. Thischaracteristic crucial versioning incremental deploymentof new assertions provider's policy toinclude new assertions new alternatives allowing entitiesto continue use old alternatives backward-compatiblemanner. Expression section convey policy interoperable form, using XMLInfoset representation policy. Apolicy expression XML Infoset representation apolicy, normalform equivalent compact form.] normal form Section Normal Form PolicyExpression) policy expression moststraightforward XML Infoset representation policy datamodel. Equivalent, alternative representations allow policy authorsto compactly express policy Section Compact PolicyExpression). Policy authors be more interested thecompact form Section Compact PolicyExpression), definitions describewhat valid policy language XML Schema. policy language XML Schema representation thecompact form, normal form more restrictive outlined inSection Normal FormPolicy Expression. Normal Form PolicyExpression facilitate interoperability, specification anormal form policy expressions astraightforward XML Infoset representation policy, enumeratingeach alternatives turn enumerate eachof assertions. schema outline thenormal form policy expression <wsp:Policy … >(02) <wsp:ExactlyOne>(03) <wsp:All> <Assertion …> … </Assertion> </wsp:All> </wsp:ExactlyOne>(05) </wsp:Policy> following Element Information Items defined inthe schema outline policy expression. collection policy alternatives. there are ElementInformation Items property,there are admissible policy alternatives, i.e., behavior isadmissible. policy alternative; collection policy assertions. Ifthere are Element Information Items property, admissible policyalternative empty, i.e., behavior specified. XML Infoset representation policy assertion. Additional attributes MAY bespecified MUST NOT contradict thesemantics element]; attributeis not recognized, beignored. assertion normal form policyexpression nested policy expression, thenested policy expression MUST containat most policy alternative Policy AssertionNesting). simplify processing improve interoperability, normalform policy expression beused practical. example, following normal form policyexpression. <wsp:Policy xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:wsp="http://www.w3.org/ns/ws-policy" >(02) <wsp:ExactlyOne>(03) <wsp:All>(04) <sp:SignedParts>(05) <sp:Body/>(06) </sp:SignedParts>(07) </wsp:All>(08) <wsp:All>(09) <sp:EncryptedParts>(10) <sp:Body/>(11) </sp:EncryptedParts>(12) </wsp:All>(13) </wsp:ExactlyOne>(14) </wsp:Policy> Lines Lines express alternatives inthe policy. first alternative selected, message bodyneeds be signed supported;conversely, second alternative selected, message bodyneeds be encrypted. Policy Identification policyexpression MAY be associated withan IRI RFC Theschema outline attributes associate IRI asfollows: <wsp:Policy Name="xs:anyURI" wsu:Id="xs:ID" xml:id="xs:ID" … >(04) …(05) </wsp:Policy> following Attribute Information Items listedand defined schema outline identity policy expression absolute IRI[IETF RFC omitted,there implied value. IRI MAY be used refer policy other XMLdocuments using policy attachment mechanism such thosedefined WS-PolicyAttachment Services Policy Attachment].[Definition: policy attachment amechanism associating policy more policy scopes.] policyscope collection policy subjects policy mayapply.] @xml:id) identity policy expression IDwithin enclosing XML document. omitted, there impliedvalue. constraints XML ID type MUST be met. refer policyexpression, IRI-reference MAY beformed using value Section WS-Security[WS-Security when@wsu:Id used. Note: use xml:id attribute conjunction withCanonical XML inappropriate described Appendix C ofxml:id Version ID] andthus combination be avoided Note]). example, policyexpression identified using xml:id attribute shouldnot be signed using XML Digital Signature Canonical XML isbeing used canonicalization method. Note: Canonical XML isintended address issues occur Canonical XML xml:id. W3C XML SecuritySpecifications Maintenance WG been chartered address tointegrate Canonical XML XML Security, including XMLSignature following example associate policyexpression absolute IRI"http://www.example.com/policies/P1": <wsp:Policy Name="http://www.example.com/policies/P1" xmlns:wsp="http://www.w3.org/ns/ws-policy" >(02) <!-- Details omitted readability </wsp:Policy> following example associate policyexpression IRI-reference <wsp:Policy wsu:Id="P1" xmlns:wsp="http://www.w3.org/ns/ws-policy" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" >(02) <!-- Details omitted readability </wsp:Policy> Compact Policy Expression express policy compact form still using XML Infoset, thisspecification constructs: attribute decorate anassertion,semantics recursively nested policy operators, policyreference/inclusion mechanism. sub section aconstruct equivalent normal form. interpret compactexpression interoperable form, policy expression thecompact form be converted Section Normalization) normal form(see Section NormalForm Policy Expression). policyexpression wsp:Policy wrapperelement more child descendent elements. Optional PolicyAssertions indicate policy assertion optional, thisspecification attribute compact authoringstyle expressing pair alternatives, withoutthat assertion. schema outline attribute asfollows: <Assertion wsp:Optional="xs:boolean" …> … </Assertion> following Attribute Information Item definedin schema outline actual value XML Schema Part Schema Structures]) true, theexpression assertion semantically equivalent thefollowing: <wsp:ExactlyOne>(02) <wsp:All> <Assertion …> … </Assertion> </wsp:All>(03) <wsp:All </wsp:ExactlyOne> actual value XML Schema Part Schema Structures]) false, theexpression assertion semantically equivalent thefollowing: <wsp:ExactlyOne>(02) <wsp:All> <Assertion …> … </Assertion> </wsp:All>(03) </wsp:ExactlyOne> Omitting attribute semantically equivalent includingit value false. Policy expressions not includethis attribute value false, policy parsers mustaccept attribute value false. example, following compact policy expression: <wsp:Policy xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:wsp="http://www.w3.org/ns/ws-policy" >(02) <sp:IncludeTimestamp wsp:Optional="true" </wsp:Policy> equivalent following normal form policyexpression: <wsp:Policy xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:wsp="http://www.w3.org/ns/ws-policy" >(02) <wsp:ExactlyOne>(03) <wsp:All>(04) <sp:IncludeTimestamp </wsp:All>(06) <wsp:All </wsp:ExactlyOne>(08) </wsp:Policy> @wsp:Optional attribute Line policy expression assertion Line be included policy alternative excluded fromanother; included Lines excluded Line @wsp:Optional not appear normalform policy expression. Policy Assertion Nesting policyassertion MAY contain policyexpression. nested policyexpression policy expression ElementInformation Item property apolicyassertion.] schema outline nestedpolicy expression <Assertion …>(02) …(03) <wsp:Policy …> … </wsp:Policy> …(05) </Assertion> following additional processing constraints theoutline listed assertion nested policyexpression. there wsp:Policy ElementInformation Item property, theassertion nested policy expression. schema outline assertion type nestedpolicy expression assertion not further qualify ormore aspects behavior indicated assertion type assertions are needed nested policy expression), theassertion MUST include empty<wsp:Policy/> Element Information Item property. explained Section4.3.3 Policy Operators, equivalent nested policy expression singlealternative assertions. Note: specification not define processing forarbitrary wsp:Policy Element Information Items thedescendants assertion parameter, e.g., property <Lorem>(03) <Ipsum>(04) <wsp:Policy> …(06) </wsp:Policy>(07) </Ipsum>(08) </Lorem>(09)</wsp:Policy> Policy assertions containing nested policy expression arenormalized recursively. nesting policy expression awsp:Policy child) retained normal form, butin normal form, nested policy expression mostone policy alternative. assertion nested policyexpression E, E more policy alternative, Ais duplicated such there are many instances choicesin E, nested policy expression duplicate asingle choice. process applied recursively theassertions choices nested policyexpression, Intuitively, compact policy thought ofas tree branches have branches etc, normal form, apolicy stump straight vines. example, consider following policy expression withnested policy expressions compact form: <wsp:Policy xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:wsp="http://www.w3.org/ns/ws-policy" >(02) <sp:TransportBinding>(03) <wsp:Policy>(04) <sp:AlgorithmSuite>(05) <wsp:Policy>(06) <wsp:ExactlyOne>(07) <sp:Basic256Rsa15 <sp:TripleDesRsa15 </wsp:ExactlyOne>(10) </wsp:Policy>(11) </sp:AlgorithmSuite>(12) <sp:TransportToken>(13) <wsp:Policy> <sp:HttpsToken> <wsp:Policy/> </sp:HttpsToken>(15) </wsp:Policy>(16) </sp:TransportToken> <!-- Details omitted readability </wsp:Policy>(18) </sp:TransportBinding>(19) </wsp:Policy> Lines policy expression contain singletransport binding security policy assertion; nestedpolicy expression algorithm suite assertion(Lines 04-11) nested policy expression containstwo policy alternatives Generally, nested policyexpression recursive processing; example above, indicated transport binding assertion indicated assertions algorithmsuite assertion. example equivalent following: <wsp:Policy xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:wsp="http://www.w3.org/ns/ws-policy" >(02) <wsp:ExactlyOne>(03) <wsp:All>(04) <sp:TransportBinding>(05) <wsp:Policy>(06) <sp:AlgorithmSuite>(07) <wsp:Policy>(08) <sp:Basic256Rsa15 </wsp:Policy>(10) </sp:AlgorithmSuite>(11) <sp:TransportToken>(12) <wsp:Policy> <sp:HttpsToken> <wsp:Policy/> </sp:HttpsToken>(14) </wsp:Policy>(15) </sp:TransportToken> <!-- Details omitted readability </wsp:Policy>(17) </sp:TransportBinding>(18) </wsp:All>(19) <wsp:All>(20) <sp:TransportBinding>(21) <wsp:Policy>(22) <sp:AlgorithmSuite>(23) <wsp:Policy>(24) <sp:TripleDesRsa15 </wsp:Policy>(26) </sp:AlgorithmSuite>(27) <sp:TransportToken>(28) <wsp:Policy> <sp:HttpsToken> <wsp:Policy/> </sp:HttpsToken>(30) </wsp:Policy>(31) </sp:TransportToken> <!-- Details omitted readability </wsp:Policy>(33) </sp:TransportBinding>(34) </wsp:All>(35) </wsp:ExactlyOne>(36) </wsp:Policy> listing above, transport binding nestedpolicy expression have been duplicated once nestedalternatives Lines compact policy. firstalternative 03-18) single nested algorithm suitealternative 08) second alternative 19-34and Operators Policies are used conveya set capabilities, requirements, general characteristics ofentities Introduction).These are generally expressible set policyalternatives. Policy operators wsp:ExactlyOne elements) areused group policy assertions policyalternatives. compactly express complex policies, policyoperators MAY be recursively nested;that more instances wsp:Policy,wsp:All, wsp:ExactlyOneMAY be nested withinwsp:Policy, wsp:All, and/orwsp:ExactlyOne. schema outline wsp:Policy element inthe compact form <wsp:Policy … >(02) <wsp:Policy …>…</wsp:Policy> <wsp:ExactlyOne>…</wsp:ExactlyOne> <wsp:All>…</wsp:All> <wsp:PolicyReference … >…</wsp:PolicyReference> …(07) </wsp:Policy> following Attribute Element InformationItems defined schema outline element wsp:Policy operator. element nested wsp:Policy operator. element nested wsp:ExactlyOneoperator. element nested wsp:All operator. element references policy expression be included perSection PolicyInclusion. Additional attributes MAY bespecified MUST NOT contradict thesemantics element]; attributeis not recognized, beignored. Additional elements MAY bespecified. Such elements MUST NOT usethe Web Services Policy language XML namespace name andMUST NOT contradict semantics ofthe element]. schema outline wsp:ExactlyOne elementin compact form <wsp:ExactlyOne>(02) <wsp:Policy … >…</wsp:Policy> <wsp:ExactlyOne>…</wsp:ExactlyOne> <wsp:All>…</wsp:All> <wsp:PolicyReference … >…</wsp:PolicyReference> …(07) </wsp:ExactlyOne> following Attribute Element InformationItems defined schema outline element wsp:ExactlyOne operator. element nested wsp:Policy operator. element nested wsp:ExactlyOneoperator. element nested wsp:All operator. element references policy expression be included perSection PolicyInclusion. Additional elements MAY bespecified. Such elements MUST NOT usethe Web Services Policy language XML namespace name andMUST NOT contradict semantics ofthe element]. schema outline wsp:All element thecompact form <wsp:All>(02) <wsp:Policy … >…</wsp:Policy> <wsp:ExactlyOne>…</wsp:ExactlyOne> <wsp:All>…</wsp:All> <wsp:PolicyReference … >…</wsp:PolicyReference> …(07) </wsp:All> following Attribute Element InformationItems defined schema outline element wsp:All operator. element nested wsp:Policy operator. element nested wsp:ExactlyOneoperator. element nested wsp:All operator. element references policy expression be included perSection PolicyInclusion. Additional elements MAY bespecified. Such elements MUST NOT usethe Web Services Policy language XML namespace name andMUST NOT contradict semantics ofthe element]. Note: wsp:All wsp:ExactlyOneelements do not allow attribute extensibility suchattributes be preserved normalization. following rules are used transform compact policyexpression normal form policy expression: Equivalence Use wsp:Policy operator policyexpression equivalent wsp:All. collection assertions wsp:All operatoris equivalent policy alternative. instance, <wsp:All>(02) <!-- assertion <!-- assertion </wsp:All> equivalent <wsp:ExactlyOne>(02) <wsp:All>(03) <!-- assertion <!-- assertion </wsp:All>(06) </wsp:ExactlyOne> Empty <wsp:All policy alternativewith policy assertions. Note sincewsp:Policy equivalent wsp:All,<wsp:Policy therefore equivalent i.e., policy alternative withzero assertions. <wsp:ExactlyOne policy withzero policy alternatives. Commutative line previous statements policy assertionswithin policy alternative policy alternatives policyare not ordered PolicyAlternative Policy,respectively), wsp:All wsp:ExactlyOneare commutative. example, <wsp:All> <!-- assertion <!-- assertion </wsp:All> equivalent <wsp:All> <!-- assertion <!-- assertion </wsp:All> <wsp:ExactlyOne>(02) <!-- assertion <!-- assertion </wsp:ExactlyOne> equivalent <wsp:ExactlyOne>(02) <!-- assertion <!-- assertion </wsp:ExactlyOne> Associative wsp:All wsp:ExactlyOne areassociative. example, <wsp:All>(02) <!-- assertion <wsp:All> <!-- assertion </wsp:All>(04) </wsp:All> equivalent <wsp:All> <!-- assertion <!-- assertion </wsp:All> <wsp:ExactlyOne>(02) <!-- assertion <wsp:ExactlyOne> <!-- assertion </wsp:ExactlyOne>(04) </wsp:ExactlyOne> equivalent <wsp:ExactlyOne>(02) <!-- assertion <!-- assertion </wsp:ExactlyOne> Idempotent wsp:All wsp:ExactlyOne areidempotent. example, <wsp:All>(02) <wsp:All> <!-- assertion <!-- assertion </wsp:All>(03) </wsp:All> equivalent <wsp:All> <!-- assertion <!-- assertion </wsp:All> <wsp:ExactlyOne>(02) <wsp:ExactlyOne>(03) <!-- assertion <!-- assertion </wsp:ExactlyOne>(05) </wsp:ExactlyOne> equivalent <wsp:ExactlyOne>(02) <!-- assertion <!-- assertion </wsp:ExactlyOne> Distributive wsp:All distributive overwsp:ExactlyOne. wsp:Allelement containing only wsp:ExactlyOne child elementsis equivalent wsp:ExactlyOne element containing,for possible combination child element thewsp:ExactlyOne element being distributed, awsp:All element containing combination. Forexample, <wsp:All>(02) <wsp:ExactlyOne>(03) <!-- assertion <!-- assertion </wsp:ExactlyOne>(06) </wsp:All> equivalent <wsp:ExactlyOne>(02) <wsp:All>(03) <!-- assertion </wsp:All>(05) <wsp:All>(06) <!-- assertion </wsp:All>(08) </wsp:ExactlyOne> Similarly repeatedly distributing wsp:All overwsp:ExactlyOne, <wsp:All>(02) <wsp:ExactlyOne>(03) <!-- assertion <!-- assertion </wsp:ExactlyOne>(06) <wsp:ExactlyOne>(07) <!-- assertion <!-- assertion </wsp:ExactlyOne>(10) </wsp:All> equivalent <wsp:ExactlyOne>(02) <wsp:All><!-- assertion assertion <wsp:All><!-- assertion assertion <wsp:All><!-- assertion assertion <wsp:All><!-- assertion assertion </wsp:ExactlyOne> Distributing wsp:All emptywsp:ExactlyOne equivalent alternatives. Forexample, <wsp:All>(02) <wsp:ExactlyOne </wsp:All> equivalent <wsp:ExactlyOne <wsp:All>(02) <wsp:ExactlyOne>(03) <!-- assertion <!-- assertion </wsp:ExactlyOne>(06) <wsp:ExactlyOne </wsp:All> equivalent <wsp:ExactlyOne example, given following compact policy expression: <wsp:Policy xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:wsp="http://www.w3.org/ns/ws-policy" >(02) <sp:RequireDerivedKeys wsp:Optional="true" <wsp:ExactlyOne>(04) <sp:WssUsernameToken10 <sp:WssUsernameToken11 </wsp:ExactlyOne>(07) </wsp:Policy> Applying Section Policy Assertions @wsp:Optional inLine distributing wsp:All overwsp:ExactlyOne Section Policy Operators theassertions Lines yields: <wsp:Policy xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:wsp="http://www.w3.org/ns/ws-policy" >(02) <wsp:ExactlyOne>(03) <wsp:All> <!-- @wsp:Optional alternative assertion <sp:RequireDerivedKeys </wsp:All>(06) <wsp:All <!-- @wsp:Optional alternative </wsp:ExactlyOne>(08) <wsp:ExactlyOne>(09) <wsp:All>(10) <sp:WssUsernameToken10 </wsp:All>(12) <wsp:All>(13) <sp:WssUsernameToken11 </wsp:All>(15) </wsp:ExactlyOne>(16) </wsp:Policy> Note assertion listed Line first listingexpands alternatives Lines secondlisting. Finally, noting wsp:Policy equivalent towsp:All, distributing wsp:All overwsp:ExactlyOne yields following normal form policyexpression: <wsp:Policy xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:wsp="http://www.w3.org/ns/ws-policy" >(02) <wsp:ExactlyOne>(03) <wsp:All>(04) <sp:RequireDerivedKeys <sp:WssUsernameToken10 </wsp:All>(07) <wsp:All>(08) <sp:RequireDerivedKeys <sp:WssUsernameToken11 </wsp:All>(11) <wsp:All>(12) <sp:WssUsernameToken10 </wsp:All>(14) <wsp:All>(15) <sp:WssUsernameToken11 </wsp:All>(17) </wsp:ExactlyOne>(18) </wsp:Policy> Note alternatives listed Lines thesecond listing are combined alternatives listed inLines second listing create alternatives inthe normalized policy, Lines Consider example, given following compact policyexpression: <wsp:Policy xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:wsp="http://www.w3.org/ns/ws-policy" >(02) <sp:RequireDerivedKeys <wsp:ExactlyOne>(04) <sp:WssUsernameToken10 <sp:WssUsernameToken11 </wsp:ExactlyOne>(07) </wsp:Policy> Applying Section Policy Assertions to@wsp:Optional="false" Line distributingwsp:All wsp:ExactlyOne Section Policy Operators theassertions Lines yields: <wsp:Policy xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:wsp="http://www.w3.org/ns/ws-policy" >(02) <wsp:ExactlyOne>(03) <wsp:All>(04) <sp:RequireDerivedKeys </wsp:All>(06) </wsp:ExactlyOne>(07) <wsp:ExactlyOne>(08) <wsp:All>(09) <sp:WssUsernameToken10 </wsp:All>(11) <wsp:All>(12) <sp:WssUsernameToken11 </wsp:All>(14) </wsp:ExactlyOne>(15) </wsp:Policy> Note assertion listed Line first listingexpands alternative Lines secondlisting. Finally, noting wsp:Policy equivalent towsp:All, distributing wsp:All overwsp:ExactlyOne yields following normal form policyexpression: <wsp:Policy xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:wsp="http://www.w3.org/ns/ws-policy" >(02) <wsp:ExactlyOne>(03) <wsp:All>(04) <sp:RequireDerivedKeys <sp:WssUsernameToken10 </wsp:All>(07) <wsp:All>(08) <sp:RequireDerivedKeys <sp:WssUsernameToken11 </wsp:All>(11) </wsp:ExactlyOne>(12) </wsp:Policy> Note first alternative listed Lines thesecond listing combined alternatives listed inLines second listing create alternatives inthe normalized policy, Lines References wsp:PolicyReference element used toreference policy expressions. semantics thewsp:PolicyReference element are determined thecontext used example, see Policy Inclusion). schema outline wsp:PolicyReferenceelement <wsp:PolicyReference(02) URI="xs:anyURI"(03) Digest="xs:base64Binary" DigestAlgorithm="xs:anyURI" … >(05) …(06) </wsp:PolicyReference> following Attribute Element InformationItems defined schema outline element references policy expression beingreferenced. attribute references policy expression IRI. apolicy expression same XML Document, referenceSHOULD be IRI-reference policyexpression identified ID. external policyexpression, there requirement IRI be resolvable;retrieval mechanisms are scope specification.After retrieval, there requirement check theretrieved policy expression associated Policy Identification) withthis IRI. IRI included retrieved policyexpression, MAY be differentthan IRI used retrieve policy expression. attribute type xs:base64Binary andspecifies digest referenced policy expression. isused ensure included policy expected policy. Ifomitted, there implied value. optional URI attribute digest algorithmsbeing used. specification predefines default algorithmbelow, additional algorithms be expressed. URI Description http://www.w3.org/ns/ws-policy/Sha1Exc digest SHA1 hash theoctet stream resulting using Exclusive XMLcanonicalization defined XML Signature Additional attributes MAY bespecified MUST NOT contradict thesemantics element]; attributeis not recognized, beignored. Additional elements MAY bespecified MUST NOT contradict thesemantics element]; elementis not recognized, beignored. Inclusion order share assertions policyexpressions, wsp:PolicyReference elementMAY be present anywhere policyassertion allowed policy expression. element isused include content policy expression anotherpolicy expression. wsp:PolicyReference element references awsp:Policy element, then semantics inclusionare simply replace wsp:PolicyReference elementwith wsp:All element property same property referencedwsp:Policy element. contents thereferenced policy conceptually replace thewsp:PolicyReference element are wrapped awsp:All operator. Using thewsp:PolicyReference element, policy expressionMUST NOT reference eitherdirectly indirectly. References have attribute SHOULDbe validated being included.) example policies include extend commonpolicy. first example there single policy documentcontaining policy assertions. expression given anidentifier not fully qualified location. second thirdexpressions reference first expression URI indicating thereferenced expression document. <wsp:Policy xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:wsp="http://www.w3.org/ns/ws-policy" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" wsu:Id="Protection" >(02) <sp:EncryptSignature wsp:Optional="true" <sp:ProtectTokens wsp:Optional="true" </wsp:Policy> <wsp:Policy xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:wsp="http://www.w3.org/ns/ws-policy" >(02) <wsp:PolicyReference URI="#Protection" <sp:OnlySignEntireHeadersAndBody </wsp:Policy> <wsp:Policy xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:wsp="http://www.w3.org/ns/ws-policy" >(02) <sp:IncludeTimestamp <wsp:PolicyReference URI="#Protection" <sp:OnlySignEntireHeadersAndBody </wsp:Policy> are times desirable portion apolicy expression. Generally, be accomplished placingthe common assertions separate policy expression andreferencing interpret compact expression interoperable form, acompact expression be converted corresponding normalform expression following procedure: Start Element Information Item E defined XMLInformation Set InformationSet]) policy expression. E always"http://www.w3.org/ns/ws-policy". base case,the name] property E recursive case, property E Expand Element Information Items defined XMLInformation Set InformationSet]) property Ethat are policy references Section Policy Inclusion. Convert Element Information Item C property E normal form. name] property C name] property C C expression policy operator;normalize C recursively applying procedure. Otherwise Element Information Item C assertion;normalize C Sections Optional PolicyAssertions Assertion Nesting. Apply policy operator indicated E normalizedElement Information Items construct normal form Section Policy Operators Normal Form PolicyExpression. Note implementation use more efficient procedureand not required explicitly convert compact expression intothe normal form long processing results areindistinguishable doing so. Ignorable PolicyAssertions wsp:Ignorable attribute policyassertion ignorable policy assertion. Thebehavior implied ignorable assertion expected be abehavior need not be engaged successful interoperationwith entity such ignorable assertions itspolicy. schema outline wsp:Ignorable attributeis <Assertion wsp:Ignorable="xs:boolean" … > … </Assertion> following Attribute Information Item definedin schema outline attribute type xs:boolean. actualvalue XML Schema Part Structures]) true, assertion anignorable policy assertion. Ifthe actual value false, assertion not ignorable policy assertion.Omitting attribute semantically equivalent including itwith value false. Intersection Policy intersection OPTIONAL useful tool ormore parties express policyand want limit policy alternatives aremutually compatible. example, requester providerexpress requirements message exchange, intersection identifiescompatible policy alternatives included requesterand provider policies. Policy Intersection commutativeoperation performed policies yields policy thatcontains collection compatible policy alternatives. policy intersection times analogous setintersection, not imply formal set intersection semantics).There are modes intersection: strict lax. modeis selected indicated policy intersection thescope specification. first approximation, intersection algorithm definedbelow compatibility policy assertionsin domain-independent manner. Mechanisms determiningassertion parameter compatibilityare not part domain-independent policy intersection.Determining policy assertions same type arecompatible involve domain-specific processing purposes ofdetermining assertion parametercompatibility. Domain-independent policy intersection beextended include domain-specific processing. adomain-specific intersection processing algorithm required be known QName specific assertiontype involved policy alternative. However, regardlessof assertion's QName domain-specificprocessing, implementation domain-independentintersection need not apply domain-specific processing. domain-independent policy intersection algorithm policyassertions are compatible have same typeand assertion nested policyexpression, assertions are compatible havea nested policy expression alternative nested policyexpression compatible alternative nestedpolicy expression other. Assertion parameters are not partof domain-independent compatibility determination definedherein domain-independent policy intersection beextended include domain-specific processing purposes ofdetermining Assertion parametercompatibility. mode strict, policy alternatives B arecompatible: assertion compatible assertion B,and assertion B compatible assertion A. mode lax, policy alternatives B arecompatible: assertion not ignorable policy assertion iscompatible assertion B, assertion B not ignorable policy assertion iscompatible assertion A. alternatives are compatible, intersection analternative containing occurrences theassertions alternatives bag union not are marked thewsp:Ignorable='true' attribute. policies are compatibleif alternative compatible alternative theother. policies are compatible, intersection intersections pairs compatiblealternatives, choosing alternative policy. twopolicies are not compatible, intersection policyalternatives. result policy intersection be more alternatives.Each alternative contain more oneassertionof same type come differentinput policies. See Section3.2 Policy Alternativefor mechanisms determining aggregate behavior indicated bymultiple assertions same policyassertion type. policy assertion authors did not specify thesemantics multiple assertions same assertiontype policy alternative type andits descendant assertion types nestedpolicy expression outline, do not allow parameters, then multipleassertionsof type policyalternative intersection result have same meaning asa single assertion typewithin policy alternative. entity behaviors implied policyalternative policy alternative chosen theintersection result Policies ofEntities Web Services Based System). entityincludes policy assertion type policy, policyassertion type not occur intersected result, then thatentity not apply behavior implied assertion type A.If policy assertion type Z not included input policiesbeing intersected then intersection result silent implied assertion type Z. example intersection, consider input policies innormal form: <wsp:Policy xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:wsp="http://www.w3.org/ns/ws-policy" > <!-- Policy P1 <wsp:ExactlyOne>(03) <wsp:All> <!-- Alternative A1 <sp:SignedElements>(05) <sp:XPath>/S:Envelope/S:Body</sp:XPath>(06) </sp:SignedElements>(07) <sp:EncryptedElements>(08) <sp:XPath>/S:Envelope/S:Body</sp:XPath>(09) </sp:EncryptedElements>(10) </wsp:All>(11) <wsp:All> <!-- Alternative A2 <sp:SignedParts>(13) <sp:Body <sp:Header Namespace="http://www.w3.org/2005/08/addressing" </sp:SignedParts>(16) <sp:EncryptedParts>(17) <sp:Body </sp:EncryptedParts>(19) </wsp:All>(20) </wsp:ExactlyOne>(21) </wsp:Policy> listing policy alternatives. firstalternative, policy assertions. Oneindicates elements be signed typeis sp:SignedElements 04), parametersinclude XPath expression content be signed 05).The other assertion similar structure: type(Line 07) parameters 08). second alternative also twoassertions, type Line parameters(Lines Line example compatibility policyassertions based assertion type delegates parameterprocessing domain-specific processing. <wsp:Policy xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:wsp="http://www.w3.org/ns/ws-policy" > <!-- Policy P2 <wsp:ExactlyOne>(03) <wsp:All> <!-- Alternative A3 <sp:SignedParts <sp:EncryptedParts>(06) <sp:Body </sp:EncryptedParts>(08) </wsp:All>(09) <wsp:All> <!-- Alternative A4 <sp:SignedElements>(11) <sp:XPath>/S:Envelope/S:Body</sp:XPath>(12) </sp:SignedElements>(13) </wsp:All>(14) </wsp:ExactlyOne>(15) </wsp:Policy> there only alternative policy P1 assertion type alternative policy P2, theintersection policy single alternative containsall assertions A2 A3. <wsp:Policy xmlns:sp="http://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702" xmlns:wsp="http://www.w3.org/ns/ws-policy" > <!-- Intersection P1 P2 <wsp:ExactlyOne>(03) <wsp:All>(04) <sp:SignedParts >(05) <sp:Body <sp:Header Namespace="http://www.w3.org/2005/08/addressing" </sp:SignedParts>(08) <sp:EncryptedParts>(09) <sp:Body </sp:EncryptedParts>(11) <sp:SignedParts <sp:EncryptedParts>(13) <sp:Body </sp:EncryptedParts>(15) </wsp:All>(16) </wsp:ExactlyOne>(17) </wsp:Policy> Note there are assertions typesp:SignedParts assertions typesp:EncryptedParts, inputPolicies. general, whethertwo assertions same type arecompatible repetition redundancy thedomain-specific semantics assertion type. mentionedabove, assertions have parameters assertions innested policiy expressions have noparameters, then multipleassertionsof type policyalternative intersection result have same meaning asa single assertion typewithin policy alternative. Based semantics multiple assertions EncryptedPartsassertion type, specified theWS-SecurityPolicy specification,one sp:EncryptedParts assertion theabove example redundant. sp:SignedParts assertions arecompatible redundant semanticsdefined assertion type. example intersection WS-Addressing assertionsthat utilize framework intersection algorithm, consider twoinput policies: <wsp:Policy xmlns:wsp="http://www.w3.org/ns/ws-policy" xmlns:wsam="http://www.w3.org/2007/05/addressing/metadata" >(02) <wsp:ExactlyOne>(03) <wsp:All> <!-- Alternative A5 <wsam:Addressing>(05) <wsp:Policy/>(06) </wsam:Addressing>(07) </wsp:All>(08) </wsp:ExactlyOne>(09) </wsp:Policy> Lines policy expression contain anaddressing policy assertion empty<wsp:Policy/> line empty<wsp:Policy/> nested policy expression withan alternative assertions. example above, theaddressing assertion use addressing anyrestriction. <wsp:Policy xmlns:wsp="http://www.w3.org/ns/ws-policy" xmlns:wsam="http://www.w3.org/2007/05/addressing/metadata" >(02) <wsp:ExactlyOne>(03) <wsp:All> <!-- Alternative A6 <wsam:Addressing>(05) <wsp:Policy>(06) <wsam:AnonymousResponses/>(07) </wsp:Policy>(08) </wsam:Addressing>(09) </wsp:All>(10) </wsp:ExactlyOne>(11) </wsp:Policy> Lines policy expression contain anaddressing policy assertion nested policy expression inlines nested policy expression theprovider request messages use response endpoint EPRsthat contain anonymous URI. nested policy expressioncontains alternative assertion,wsam:AnonymousResponses. assertions alternatives A5 A6 have sameassertion type have nested policy expressions. nestedpolicy expression addressing assertion thealternative A5 alternative assertions.The nested policy expression addressing assertion thealternative A6 alternative assertion. Thenested policy expressions assertions areincompatible alternative incompatible withthe alternative other. Therefore, assertions are incompatible hence twoalternatives are incompatible. Use IRIs PolicyExpressions Policy expressions use IRIs identifiers. documentdoes not define base URI mechanisms defined inXML Base BASE] RFCs3023 RFC RFC RFC forestablishing base URI relative IRIs be madeabsolute. Security Considerations RECOMMENDED policies assertions beintegrity protected permit detection tampering. canbe done using technology such XML DSig SSL/TLS RFC WS-Security Policies NOT be acceptedunless are signed have associated security token tospecify signer right scope containing thepolicy. relying party rely policy unlessthe policy signed presented sufficient credentials topass relying parties' acceptance criteria. be noted mechanisms described thisdocument be secured part SOAP message SOAP Framework] using WS-Security embedded withinother objects using object-specific security mechanisms. section security considerations serviceproviders, requestors, policy authors, policy assertion authors,and policy implementers need consider exposing, consumingand designing policy expressions, authoring policyassertions implementing policy. Information DisclosureThreats policy used represent capabilities requirementsof Web Service. Policies include sensitive information.Malicious consumers acquire sensitive information, fingerprintthe service infer service vulnerabilities. threats bemitigated requiring authentication sensitive information, byomitting sensitive information policy securingaccess policy. securing access policy metadata,policy providers use mechanisms other Web Servicesspecifications such WS-Security WS-MetadataExchange[WS-MetadataExchange] Spoofing TamperingThreats policy expression unsigned be easily tamperedwith replaced. prevent tampering spoofing policy,requestors discard policy signed theprovider presented sufficient credentials. Requestorsshould also check signer actually authorized expresspolicies given policy subject. Threats policy offer several alternatives vary weak tostrong set requirements. adversary interfere removeall alternatives weakest securityrequirements). adversary interfere discard thispolicy insert weaker policy previously issued sameprovider. Policy authors providers mitigate threats bysun-setting older weaker policy alternatives. Requestors canmitigate threats discarding policies aresigned provider. Threats Malicious providers include policy assertions policywhose behavior be verified examining wire messagefrom provider requestor. general, requestors have noguarantee provider behave described theprovider’s policy expression. provider not perform amalicious activity. example, say policy assertion isprivacy notice information provider semanticsby disclosing private information. Requestors mitigate thisthreat discarding policy alternatives include assertionswhose behavior be verified examining wire messagefrom provider requestor. Assertion authors mitigate thisthreat not designing assertions behavior beverified using wire messages. Denial Service Threats Malicious providers provide policy expression largenumber alternatives, large number assertions inalternatives, deeply nested policy expressions chains ofPolicyReference elements expand exponentially chainedsample similar well-known DTD entityexpansion attack). Policy implementers need anticipate theserogue providers use configurable bound defaults onnumber policy alternatives, number assertions analternative, depth nested policy expressions, etc. Example5-1. Chained Policy Reference Elements <wsp:Policy wsu:Id="p1">(02) <wsp:PolicyReference URI="#p2"/ >(03) <wsp:PolicyReference URI="#p2"/>(04) </wsp:Policy>(05) <wsp:Policy wsu:Id="p2" >(07) <wsp:PolicyReference URI="#p3"/>(08) <wsp:PolicyReference URI="#p3"/>(09) </wsp:Policy>(10) <wsp:Policy wsu:Id="p3" >(12) <wsp:PolicyReference URI="#p4"/>(13) <wsp:PolicyReference URI="#p4"/>(14) </wsp:Policy>(15) <!-- Policy/@wsu:Id p4 p99 <wsp:Policy wsu:Id="p100" >(19) <wsp:PolicyReference URI="#p101"/>(20) <wsp:PolicyReference URI="#p101"/>(21) </wsp:Policy>(22) <wsp:Policy wsu:Id="p101" >(24) <mtom:OptimizedMimeSerialization </wsp:Policy> Malicious providers provide policy expression thatincludes multiple PolicyReference elements use large numberof different internet addresses. require consumers toestablish large number TCP connections. Policy implementersneed anticipate such rogue providers use configurablebound defaults number PolicyReference elements perpolicy expression. General XMLConsiderations Implementers Web Services policy language be carefulto protect software general XML threats deeplynested XML XML malicious content. Conformance element information item namespace name local part Policy orPolicyReference specification validaccording XML Schema Structures] element defined thisspecification additionally constraints contained thisspecification. Such conformant element information itemconstitutes policy expression. A. Theapplication/wspolicy+xml Media Type appendix media typewhich be used describe Web Services Policy documentsserialized XML. wsp:Policy orwsp:PolicyAttachment be root element sucha document. A.1 Registration MIME media type name: application MIME subtype name: wspolicy+xml Required parameters: none Optional parameters: charset parameter identical semantics charset parameterof media type specified IETF RFC Encoding considerations: Identical described inIETF RFC section asapplied Web Services Policy document Infoset. Security considerations: See section SecurityConsiderations document, SecurityConsideration section WebServices Policy Attachment. Interoperability considerations: are known interoperability issues. Published specifications: document WebServices Policy Attachment. Applications use media type: new media type being registered allow deploymentof Web Services Policy references Web Services Policy theWorld Wide Web. Additional information: File extension: wspolicy Fragment identifiers: syntax identical described inIETF RFC Base URI: specified IETF RFC3023, section Also see section Use IRIs PolicyExpressions document section Use IRIs Policy Attachment Web Services PolicyAttachment. Macintosh File Type code: TEXT Person email address contact furtherinformation: World Wide Web Consortium <web-human@w3.org> Intended usage: COMMON Author/Change controller: Web Services Policy specification set work productof World Wide Web Consortium's Web Service Policy WorkingGroup. W3C change control thesespecifications. B. References B.1 Normative References Services Policy Attachment] WebServices Policy Attachment, A. S. Vedamuthu, D.Orchard, F. Hirsch, M. Hondo, P. Yendluri, T. Boubez Ü.Yalçinalp, Editors. World Wide Web Consortium, 04, September version specification Web Services Policy specification ishttp://www.w3.org/TR/2007/REC-ws-policy-attach-20070904. Thelatest version ofWeb Services Policy Attachment available athttp://www.w3.org/TR/ws-policy-attach. RFC2119] Key wordsfor use RFCs Indicate Requirement Levels, S.Bradner, Author. Internet Engineering Task Force, March http://www.ietf.org/rfc/rfc2119.txt. RFC3986] UniformResource Identifier Generic Syntax T.Berners-Lee, R. Fielding L. Masinter, Authors. Network WorkingGroup, January Available athttp://www.ietf.org/rfc/rfc3986.txt. RFC3987] Internationalized ResourceIdentifiers M. Duerst M. Suignard, Authors.Internet Engineering Task Force, January Available athttp://www.ietf.org/rfc/rfc3987.txt. Web Services Security: SOAP Message Security A. Nadalin, C. Kaler, P. Hallam-Baker, R.Monzillo, Editors. Organization Advancement StructuredInformation Standards, March Available athttp://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0.pdf. XMLBase, Jonathan Marsh, Editor. World Wide Web Consortium,27 June version XML Base Recommendation ishttp://www.w3.org/TR/2001/REC-xmlbase-20010627/. latest version XML Base isavailable http://www.w3.org/TR/xmlbase/. Extensible MarkupLanguage Edition), T. Bray, J. Paoli,C. M. Sperberg-McQueen, E. Maler, Editors. World Wide WebConsortium, February revised August versionof XML Recommendation ishttp://www.w3.org/TR/2006/REC-xml-20060816. latest version XML isavailable http://www.w3.org/TR/REC-xml. ID] xml:id Version1.0, J. Marsh, D. Veillard N. Walsh, Editors. WorldWide Web Consortium, September version xml:idVersion Recommendation ishttp://www.w3.org/TR/2005/REC-xml-id-20050909/. latest version xml:id Version1.0 available http://www.w3.org/TR/xml-id/. Set] XMLInformation Set Edition), J. Cowan R. Tobin,Editors. World Wide Web Consortium, October revised 4February version XML Information SetRecommendation ishttp://www.w3.org/TR/2004/REC-xml-infoset-20040204. latest version XMLInformation Set available athttp://www.w3.org/TR/xml-infoset. Namespaces inXML T. Bray, D. Hollander, A. Layman, R. Tobin,Editors. World Wide Web Consortium, January revised 16August version Namespaces XML Recommendationis http://www.w3.org/TR/2006/REC-xml-names-20060816/. latest version Namespacesin XML available http://www.w3.org/TR/REC-xml-names. Schema Structures] XML SchemaPart Structures Second Edition, H. Thompson, D.Beech, M. Maloney, N. Mendelsohn, Editors. World Wide WebConsortium, May revised October version ofthe XML Schema Part Recommendation ishttp://www.w3.org/TR/2004/REC-xmlschema-1-20041028. latest version XML SchemaPart available http://www.w3.org/TR/xmlschema-1. Schema Datatypes] XML SchemaPart Datatypes Second Edition, P. Byron A.Malhotra, Editors. World Wide Web Consortium, May revised28 October version XML Schema Part 2Recommendation ishttp://www.w3.org/TR/2004/REC-xmlschema-2-20041028. latest version XML SchemaPart available http://www.w3.org/TR/xmlschema-2. RFC3023] IETF XML Media Types", M. Murata, S. St. Laurent, D.Kohn, July http://www.ietf.org/rfc/rfc3023.txt.) B.2 Other References Known Issueswith Canonical XML J. Kahan K. Lanz,Editors. World Wide Web Consortium, December Available athttp://www.w3.org/TR/2006/NOTE-C14N-issues-20061220/. RFC2246] IETF TLS Protocol", T. Dierks, C. Allen, January1999. http://www.ietf.org/rfc/rfc2246.txt.) Simple ObjectAccess Protocol D. Box, et al, Editors.World Wide Web Consortium, May Available athttp://www.w3.org/TR/2000/NOTE-SOAP-20000508/. Framework] SOAP Version1.2 Part Messaging Framework, M. Gudgin, M. Hadley,N. Mendelsohn, J-J. Moreau, H. Frystyk Nielsen, Editors. World WideWeb Consortium, June revised April versionof SOAP Version Part Messaging Framework Recommendationis http://www.w3.org/TR/2007/REC-soap12-part1-20070427/. Thelatest version SOAPVersion Part Messaging Framework available athttp://www.w3.org/TR/soap12-part1/. XML SecuritySpecifications Maintenance Working Group Seehttp://www.w3.org/2007/xmlsec. API2.0] UDDIVersion API, T. Bellwood, Editor. Organization forthe Advancement Structured Information Standards, July version UDDI Version API ishttp://uddi.org/pubs/ProgrammersAPI-V2.04-Published-20020719.htm.The latestversion UDDI API available athttp://uddi.org/pubs/ProgrammersAPI_v2.htm. Data Structure UDDIVersion Data Structure Reference, C. von Riegen,Editor. Organization Advancement Structured InformationStandards, July version UDDI Version DataStructures ishttp://uddi.org/pubs/DataStructure-V2.03-Published-20020719.htm.The latestversion UDDI Data Structures available athttp://uddi.org/pubs/DataStructure_v2.htm. UDDI Version L. Clément, et al, Editors.Organization Advancement Structured InformationStandards, October version UDDI Version ishttp://www.oasis-open.org/committees/uddi-spec/doc/spec/v3/uddi-v3.0.2-20041019.htm.The latest version ofthe UDDI specification available athttp://uddi.org/pubs/uddi_v3.htm. Metadata] WebServices Addressing Metadata, M. Gudgin, M.Hadley, T. Rogers Ü. Yalçinalp, Editors. World Wide WebConsortium, September version Web ServicesAddressing Metadata ishttp://www.w3.org/TR/2007/REC-ws-addr-metadata-20070904/. Thelatest version ofWeb Services Addressing Metadata available athttp://www.w3.org/TR/ws-addr-metadata. WS-SecurityPolicy v1.2, A. Nadalin, M. Goodner, M.Gudgin, A. Barbir, H. Granqvist, Editors. Organization theAdvancement Structured Information Standards, July athttp://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702/ws-securitypolicy-1.2-spec-os.pdf.Namespace document available athttp://docs.oasis-open.org/ws-sx/ws-securitypolicy/200702. Web ServicesDescription Language E. Christensen, et al,Authors. World Wide Web Consortium, March Available athttp://www.w3.org/TR/2001/NOTE-wsdl-20010315. CoreLanguage] Web ServicesDescription Language Version Part CoreLanguage, R. Chinnici, J. J. Moreau, A. Ryman, S.Weerawarana, Editors. World Wide Web Consortium, June Thisversion WSDL specification ishttp://www.w3.org/TR/2007/REC-wsdl20-20070626/. latest version WSDL isavailable http://www.w3.org/TR/wsdl20/. WebServices Metadata Exchange K.Ballinger, et al, Authors. BEA Systems Inc., Computer AssociatesInternational, Inc., International Business Machines Corporation,Microsoft Corporation, Inc., SAP AG, Sun Microsystems, andwebMethods, August Available athttp://schemas.xmlsoap.org/ws/2004/09/mex/. XML-SignatureSyntax Processing, D. Eastlake, J. Reagle, D.Solo, Editors. Internet Society World Wide WebConsortium, February version XML-SignatureSyntax Processing Recommendation ishttp://www.w3.org/TR/2002/REC-xmldsig-core-20020212/. latest version ofXML-Signature Syntax Processing available athttp://www.w3.org/TR/xmldsig-core/. Canonical XML1.1, J. Boyer G. Marcy Authors. W3C CandidateRecommendation, June work progress. Thisversion available athttp://www.w3.org/TR/2007/CR-xml-c14n11-20070621. latest version Canonical XML1.1 available http://www.w3.org/TR//xml-c14n11/. C.Acknowledgements document work W3C Web Services Policy WorkingGroup. Members Working Group are time writing, byalphabetical order): Dimitar Angelov AG), Abbie Barbir Charlton Barreto Systems Inc.), Sergey Beryozkin(IONA Technologies, Inc.), Vladislav Bezrukov AG), TouficBoubez Technologies), Symon Chang Systems, Inc.),Paul Cotton Corporation), Glen Daniels Doug Davis Corporation), Jacques Durand Ruchith Fernando Christopher Ferris William Henry Technologies, Inc.), FrederickHirsch Maryann Hondo Corporation), Ondrej Hrebicek(Microsoft Corporation), Steve Jones Technologies), TomJordahl Systems Inc.), Paul Knight Networks),Philippe Le Hégaret Mark Little Inc.), MohammadMakarechian Corporation), Ashok Malhotra Jonathan Marsh Monica Martin Inc.), Arnaud Meyniel Software), JeffMischkinsky Corporation), Dale Moberg Software),Anthony Nadalin Corporation), David Orchard Systems,Inc.), Sanjay Patil AG), Manjula Peiris FabianRitzmann Microsystems, Inc.), Daniel Roth Tom Rutt Limited), Sanka Samaranayake(WSO2), Felix Sasaki Yakov Sverdlov AsirVedamuthu Corporation), Sanjiva Weerawarana ÜmitYalçinalp AG), Prasad Yendluri subsidiary ofSoftware AG)). Previous members Working Group were: Jeffrey Crump, JongLee, Bob Natale, Eugene Osovetsky, Bijan Parsia, Skip Snow, SeumasSoltysik, Mark Temple-Raston. people have contributed discussionson public-ws-policy@w3.org are also gratefullyacknowledged. 