Web Security Context: User Interface Guidelines Web Security Context: User Interface Guidelines W3C Recommendation August version: http://www.w3.org/TR/2010/REC-wsc-ui-20100812/ Latest version: http://www.w3.org/TR/wsc-ui/ Previous version: http://www.w3.org/TR/2010/PR-wsc-ui-20100622/ Editors: Thomas Roessler, W3C Anil Saldhana, RedHat refer errata document, include normative corrections. See also translations. Copyright © W3C® ERCIM, Keio), Rights Reserved. W3C liability, trademark document use rules apply. Abstract specification guidelines requirements presentation communication Web security context information end-users. Status Document section status document time publication. Other documents supersede document. list current W3C publications latest revision technical report be found W3C technical reports index http://www.w3.org/TR/. see Working Group's implementation report. frame development specification, Working Group had previously published use case note specification addresses most use cases issues documented note documenting best existing practice, following exceptions: specification not include advice web site authors. specification not provide advice address issue explained sections Visually extending chrome Information bar notification bar). Additionally, section Implementation testing articulated expectation recommendations specification be subject usability testing, least low fidelity level, such testing form part Candidate Recommendation exit criteria. Resources available Working Group point not permit group conduct extensive usability testing. same time, focus specification shifted documenting best existing practice. document was developed Web Security Context Working Group. list changes document Proposed Recommendation version, please refer diff document. changes were editorial nature. send comments document public-usable-authentication@w3.org public archive). document been reviewed W3C Members, software developers, other W3C groups interested parties, endorsed Director W3C Recommendation. stable document be used reference material cited document. W3C's role making Recommendation draw attention specification promote widespread deployment. functionality interoperability Web. document was produced group operating February W3C Patent Policy. W3C public list patent disclosures made connection deliverables group; page also instructions disclosing patent. Table Contents Overview Acknowledgments Conformance Product classes Language conventions Conformance levels Conformance claims Interaction content model Overview Terms definitions Common User Interface elements Applying TLS Web Certificate Handling Information Interactively accepting trust anchors certificates Augmented Assurance Certificates Validated Certificates Self-signed Certificates Untrusted Root Certificates Types TLS Mixed Content Error conditions TLS errors Error Conditions based Third Party Heuristic Information Insecure form submission Indicators Interactions Identity Trust Anchor Signaling Identity Signal Identity Signal Content Additional Security Context Information TLS indicator Error handling signaling Common Error Interaction Requirements Warning/Caution Messages Danger Messages Robustness Best Practices Keep Security Chrome Visible Do not mix content security indicators Managing User Attention APIs Exposed Web Content Obscuring disabling Security User Interfaces Software Installation Bookmarking APIs Pop-up Window APIs Security Considerations Active attacks initial TLS interactions Certificate Status Checking Failures Certificates assure identity, not security Binding readable" names domain names Warning Fatigue Mixing Augmented Assurance Validated Certificates Dynamic content change security properties Terms defined document References Overview specification deals trust decisions users make online, ways support making safe informed decisions possible. order achieve goal, specification recommendations presentation identity information user agents, Identity Signal. also include recommendations conveying error situations security protocols. error handling recommendations minimize trust decisions left users, represent known best practice inducing users safe behavior have make decisions. complement interaction decision related parts specification, Robustness Best Practices addresses question communication context information needed make decisions be made more robust attacks. document user interactions goal making security usable, based known best practice area. document intended provide user interface guidelines. Most sections assume audience certain level understanding core PKI Key Infrastructure) technologies used Web. following sections are relevant readers do not require thorough understanding PKI: Conformance, Interaction content model, Indicators Interactions, Error handling signaling, Robustness Best Practices Warning Fatigue. document part W3C specification process, written clearly lay requirements options conforming standard. User interface guidelines are not intended use standards do not have such structure. Readers more familiar latter form user interface guideline are encouraged read specification way avoid known mistakes usable security. specification companion documents: documents initial assumptions scope specification. also initial set use cases Working Group discussed. documents Working Group's initial threat analysis. document based current best practices deployed user agents, covers use cases threats documents extent. Acknowledgments specification based text Mary Ellen Zurko, Stephen Farrell, Anil Saldhana, Ian Fette, Michael McCormick, Serge Egelman, Johnathan Nightingale, Yngve N. Pettersen, Luis Barriga, Hal Lockhart, Tyler Close, Bill Doyle, Thomas Roessler, well input discussions active members Web Security Context Working Group, primarily Phillip Hallam-Baker, Mike Beltzner, Joe Steele, Jan Vidar Krey, Maritza Johnson, Rachna Dhamija Dan Schutzer. also benefited general public working group commentary earlier drafts. Conformance Product classes specification addresses Web user agents product class. Web user agents user agents are used synonymously specification. specification also addresses products incorporate changes user agents, such plug-ins, extensions, others; are summarily called plug-ins] section. Such products incorporate changes user agent, e.g. addition removal features, render otherwise conforming user agent non conforming, vice versa. Language conventions specification, RFC keywords MUST, MUST NOT, NOT, MAY are applied, respective meanings. Conformance levels user agent specification basic level] honors MUST MUST NOT clauses specification. user agent specification advanced level] also honors NOT clauses specification. Conformance plug-in defined terms conformance user agent results plug-in added base user agent. E.g., given user agent specification basic level, plug-in features lead conformance advanced level, then plug-in advanced level respect base user agent. Conformance claims claim Web user agent's conformance specification state: basic advanced conformance claimed Conformance levels) TLS protocol versions algorithms are considered strong TLS algorithms, protocol versions algorithms are supported TLS negotiation, not considered strong. user interface element TLS indicator defined specification. user interface element identity signal defined specification. broadly accepted practices are considered sufficient trust anchor be deemed augmented assurance qualified Augmented Assurance Certificates), data elements are deemed assured certificates. features claimed conformance level user agent claim plug-in's conformance specification include above, also identify base user agent respect conformance claimed. Interaction content model Overview specification human user interacting Web user agent, interacting Web resources. Many requirements specified are focused presentation security context information user, therefore directly relate user interfaces. requirements techniques are specific certain modalities, are made explicit, are part preconditions applying requirement technique. specification Web user agent describe application user Web, then term used conceptual level: assumption made implementation details; user agent" denote combination several applications, extensions such applications, operating system features, assistive technologies. common user agent therefore be web browser number plug-ins, extensions, call outs external systems render particular document formats, assistive technologies. specification makes specific assumption content user top-level Web page identified URI Web page be HTML frameset, application running top proprietary run-time environment, document format interpreted plug-ins external systems served part Web interaction. page's behavior be determined scripting, stylesheets, other mechanisms. interactive Web applications, presentation user also depend state local client be local storage structured data, be recent interactions Web page. security properties data depend security properties client computer are scope specification. requirements are expressed terms user interface components commonly found current-generation Web user agents. Terms definitions expected be consistent Web Content Accessibility Guidelines Version Terms definitions Web User Agent software presents Web content users.] Web Page resource referenced URI not embedded resource, other resources are used rendering intended be rendered together Common User Interface elements section terms user interface elements commonly present Web User Agents. Primary User Interface portions Web user agent's user interface are available users being solicited user interaction.] Examples primary user interface include location bar common Web user agents, icon present common Web user agents, error pages take place Web page not be retrieved. Secondary User Interface portions Web user agent's user interface are available user are solicited specific user interaction.] Examples secondary user interface include Information" dialog commonly found Web user agents, Properties" dialog obtained clicking padlock icon common Web user agents. occasionally use term chrome] refer representation user user agent distinct accessed web content. primary secondary user interface. Location Bar widget Web user agent's user interface displays often input textual location URI) resource being requested displayed response received).] Identity Information information web site used present identity signal.] Applying TLS Web Certificate Handling Information Public key certificates are widely used TLS have been basis generation many inappropriate warnings other dialogs users. section modifications current certificate processing aimed improving aspect handling web security context new terms describing various cases related certificate handling user agents. User agents base acceptance certificates are presented Web servers various sources, including user action, previous interactions involving same certificate, more traditionally assumed, validation certificate chain certificate issued Certification Authority practices used CAs information attested) vary CA are not available useful sense Web user agents. Interactively accepting trust anchors certificates trust anchor authoritative entity represented public key associated data. public key used verify digital signatures associated data used constrain types information trust anchor authoritative. Relying parties use trust anchors determine digitally signed information objects are valid verifying digital signatures using trust anchor's public key enforcing constraints expressed associated certificate data. Trust anchor installation typically handled user agent vendors, systems administrators device manufacturers, based out-of-band information. Note updating trust anchors therefore often handled part user agent operating system software updates. However, current user agents sometimes support interactive acceptance trust anchor session, based user interaction. Most users sensibly decide handle such interactions. Similarly, end-entity web server) certificates be currently verified using Basic Path Validation algorithm trigger current user agents offer user choice accept certificate case, sometimes single session, sometimes future sessions involving certificate, possibly scoped specific host port combinations. trust anchor certificate interactively accepted acceptance was caused user interaction user focused primary task unrelated trust certificate management.] example, web server certificate presented acceptance user ordinary Web interactions, accepted user, then matches test interactive acceptance. however, systems administrator user) trust anchor's certificate agent's store trust roots, then certificate not considered interactively accepted. Augmented Assurance Certificates trust anchors adhere documented broadly accepted practices involve level guarantee certificates chaining up roots embody augmented assurance therefore be treated more favorably terms primary security indicators. call such certificates Assurance Certificates". Augmented Assurance Certificate public key certificate issuer subject entity been authenticated means process requirements augmented assurance specification supported user agent. certificate chain such certificate MUST be validated up trust root recognized augmented assurance qualified user agent.] specification not define assurance qualified trust root" note designation made user agents band mechanism consistent relevant underlying augmented assurance specification. Marking trust anchor augmented assurance qualified security-critical step most often involve use application-specific out-of-band mechanism. Implementations MUST NOT enable users designate trust roots augmented assurance qualified part unrelated interaction. particular, notions augmented assurance qualified trust root interactively accepted trust root are mutually exclusive. addition band designation process described above, trust anchor, possibly certificates path chaining up such trust anchor need be specially marked, e.g. use specific policy object identifiers. specific marking mechanisms be used special treatment be afforded such certificates are scope document, typically be covered underlying augmented assurance specification. User agent implementers determine set such standards support associated special treatment apply, other outlined impose consistency requirements handling type certificate. derive human-readable subject name augmented assurance certificate, user agents use Subject field's Organization Country attributes. MUST use information subject certificate authority's additional assurances, documented user agent's conformance statement. Note: certificates arise future provide strong assurance holder's identity, do not include organization attribute, then user agents make use additional assurance level identity information violating specification. Such future certificates example, include high assurance certificates individuals. Validated Certificates term validated certificate used denote public key certificate been verified chaining up locally configured trust anchor. set trust anchors used given Web User agent implementation-dependent. Augmented Assurance Certificates chain up trust anchor, valid Augmented Assurance Certificates are also validated certificates. Certificates certificate chains are pinned particular destination are not considered validated certificates virtue being pinned. notion validated certificate specification domain validated certificate commonly deployed Web. type certificate binding domain name registration key pair; additional certificate attributes are often not validated. Self-signed Certificates Untrusted Root Certificates Self-signed certificates are not trust anchors are commonly used appliances web sites catering small groups users, essentially serve container cryptographic key material key exchange not verified third party. Certificate chains lead up custom root certificates are not part user agent's store trust roots are sometimes used similarly. situations, use TLS confidentiality protection services passive attackers. binding third-party asserted identity cryptographic key achieved. cases, certificates are not considered validated certificates. Using Key Continuity Management user agents use self-signed certificates certificates chain up untrusted root) determine are consistently communicating same end entity, thereby defending active attacks well. Simply put, Web site consistently presents same self-signed certificate same certificate chaining up same untrusted root) client, then be strong evidence protection active attacker been achieved well. Conversely, change certificates same site be evidence man middle attack merely indicate legitimate site changed different certificate. User agents MAY support pinning] self-signed certificate more generally certificate chain leads untrusted root certificate particular Web site, enable behavior based recorded state certificates shown previously same site. Such behavior e.g., warning users changes certificates, not showing warning messages site shows certificate consistent previous visits. interaction users pin certificate destination NOT cause self-signed certificate be pinned more site, identified URI scheme, domain, port. interaction MUST NOT cause untrusted root certificate be accepted automatically additional sites. Types TLS most common mechanism applying TLS Web use https URI scheme alternative upgrade mechanism used rarely, purposes specification, most relevant property URI used identify resource assertion use TLS desired. specification uses term HTTP transaction regardless kind TLS protection was applied; particular, transactions arising https URI dereferenced are subsumed term. HTTP transaction TLS-protected resource was identified URI https URI scheme, TLS handshake was performed successfully, HTTP transaction occurred TLS channel.] Note HTTP transaction be considered TLS protected even weak algorithms NULL encryption) are negotiated. HTTP transaction strongly TLS-protected TLS-protected, https URL was used, strong TLS algorithms were negotiated confidentiality integrity protection, least following conditions true:] server used validated certificate matches dereferenced URI; server used self-signed certificate was pinned destination; server used certificate chain leading untrusted root certificate was pinned destination. TLS modes do not require server show certificate DH_anon mode) do not lead strongly TLS-protected transaction. ability provide privacy secure connection user agent web server part determined strength capabilities TLS protocol underlying cryptographic mechanisms. TLS protocol versioned keep pace protocol features cipher suites are available. Cipher suites are grouped according algorithms key length used cryptographic functions provide cipher strength. document Strong TLS algorithms], then following hold: version TLS protocol known security flaws been negotiated. point writing document, versions SSL prior SSLv3 MUST NOT be considered strong. cipher suite been selected key algorithm strengths correspond industry practice. time writing document, cipher suites explicitly forbidden appendix A.5 MUST NOT be considered strong. set algorithms considered strong given implementation be described conformance claim specification, see Conformance claims. HTTP transaction weakly TLS-protected TLS-protected, strong TLS protection not be achieved following reasons:] TLS handshake used anonymous key exchange algorithm such DH_anon cryptographic algorithms negotiated are not considered strong certificates were used are not validated certificates, self-signed certificates pinned destination Self-signed Certificates Untrusted Root Certificates) Weakly TLS-protected interactions provide security services such confidentiality protection passive attackers, integrity protection active attackers confidentiality protection). properties are often desirable, even strong TLS protection be achieved. Mixed Content given Web page single resource only, then content user security properties derived HTTP transaction used retrieve content. Web page called TLS-secured top-level resource other resources affect control page's content presentation have been retrieved strongly TLS protected HTTP transactions. Web page called mixed content top-level resource was retrieved strongly TLS protected HTTP transaction, dependent resources were retrieved weakly protected unprotected HTTP transaction.] definition inline images, stylesheets, script content, frame content secure page need be retrieved strongly TLS protected HTTP transactions order overall page be considered TLS-secured. UI indicator used signal presence Augmented Assurance certificates MUST NOT signal presence such certificate, page TLS-secured, i.e., parts page are loaded servers presenting least validated certificate, strongly TLS-protected interactions. relevant security considerations, see Mixing Augmented Assurance Validated Certificates. Error conditions TLS errors section covers TLS-related error conditions, maps classes error handling interactions Error handling signaling) are used conditions arise. multiple error conditions apply, most severe signaling level currently known MUST be used, defined Error handling signaling. TLS negotiation, certificate chain presented server not lead trusted root certificate, certificate chain presented was not pinned destination, following Error signaling class warning higher Warning/Caution Messages Danger Messages) MUST be used signal error condition. User agents MAY offer possibility pin newly encountered certificates destination. Note untrusted certificates are accepted user interaction, additional exposure man-in-the-middle attacks created. See Active attacks initial TLS interactions more detailed discussion scenario. certificate information presented interactions described section, then human-readable information certificates MUST NOT be presented trustworthy attested. E.g., self-signed certificate's Common Name Organization attribute MUST NOT be displayed, even certificate pinned destination. User agents MAY display information dialog other secondary user interfaces reachable warning error messages specified here. TLS negotiation, end-entity certificate presented intermediate certificates certificate chain are found have been revoked, error signaling class danger Danger Messages) MUST be used. TLS negotiation, end-entity certificate presented intermediate certificates certificate chain are found have expired, error signaling class danger Danger Messages) MUST be used. URI corresponding transaction not match end-entity certificate presented, validated certificate used, then error signaling level danger Danger Messages) MUST be used. TLS negotiation otherwise error signaling level danger Danger Messages) MUST be used. TLS error conditions occur, user agents MAY choose abort connection further user interaction. guidelines section apply user agents choose cause user interaction case TLS error conditions. Note user agents combine practices: E.g., interactive approach be chosen top-level frame Web page, non-interactive approach be chosen inline content. expected XMLHttpRequest specification include non-interactive approach well. Error Conditions based Third Party Heuristic Information User agents use third party services heuristic approaches assess possible danger pending Web transaction MUST use error signaling class danger Danger Messages) signal positively identified dangers, e.g., identified malicious downloads exploits user agent vulnerabilities. signal risks are identified high likelihood, involve further user decisions phishing heuristics were triggered), error signaling class warning Warning/Caution Messages Danger Messages) MUST be used. Insecure form submission Users interacting TLS-secured page are likely develop impression information submitted interactions be strongly TLS-protected. User agents MAY warn users, using error class Warning higher Warning/Caution Messages Danger Messages), form submissions TLS-secured page are directed unsecured channel. Indicators Interactions Identity Trust Anchor Signaling section practices signaling information identity Web site user signals specified section are passive. claim made effectiveness signals counter impersonation attacks. Identity Signal User agents MUST make information identity Web site user available. identity signal be part primary user interface usage modes entail presence signaling user only presenting page content. Otherwise, MUST be available secondary user interface. Note there be usage modes requirement not apply: example, Web agent interactively switched presentation mode not display chrome need not preserve security indicators primary user interface. other hand, user agent such smart phone, individual entertainment screen airplane seat back, TV set usage mode makes minimal visible) chrome elements available need preserve security indicators such mode. User agents visual user interface MUST show Identity Signal consistent visual position. Web Content MUST NOT obscure security user interface, Obscuring disabling Security User Interfaces. Identity Signal Content Information displayed identity signal MUST be derived validated certificates, user agent state. Web user agents MUST NOT use information part identity signal taken unauthenticated untrusted sources. interactions TLS-secured Web page top-level resource been retrieved strongly TLS-protected interaction augmented assurance certificate, dependent resources have been retrieved interactions involve validated certificates, following identity signal MUST include human-readable information certificate subject, derived specified Augmented Assurance Certificates, inform user owner Web page. interactions TLS-secured Web page top-level resource been retrieved strongly TLS-protected interaction validated certificate augmented assurance certificate), following identity signal not include other human readable information identity certificate subject e.g., augmented assurance certificate), then MUST include applicable DNS name matches subject's Common Name attribute subjectAltName extension. User agents MAY shorten such DNS name displaying only suffix. inform user party responsible information, Issuer field's Organization attribute MUST be displayed Identity Signal, secondary user interface available consistent interaction Identity Signal. Subject logotypes derived certificates MUST NOT be rendered, certificate used augmented assurance certificate. Note behavior not apply self-signed certificates certificate chains chain up untrusted root certificate are used. interactions mixed content Web page, identity signal MUST NOT include site identity information use unprotected HTTP transactions. situation, identity signal MAY include indicators point error conditions occurred. interactions mixed content, user agents MUST NOT render logotypes derived certificates. Additional Security Context Information section additional security context information provided Web user agents. security context information provided primary secondary interface, meaning presented information MUST be consistent. Best practice also avoid inconsistent presentation, such using identical semantically similar icons different information different places. information sources MUST make following security context information available: Web page's domain name Owner information, consistent section Identity Signal Content Verifier information, consistent section Identity Signal Content reason displayed information trusted not). not certificate was accepted interactively, self-signed certificate was used, self-signed certificate was pinned site user trust relevant settings user agent were otherwise overridden user action. information sources make following security context information available: explanation information represented TLS indicator, e.g., concerning presence mixed content; Web page weakly TLS-protected, then, conditions cause protection be weak bad algorithms, mixed content, user visited site past. user stored credentials site. site content was encrypted transmission. site content was authenticated server authentication TLS). Additionally, information sources MAY make following security context information available: user first visited site past. often user visited site past. User agents provide information presence absence Cookies MUST NOT make claims suggest absence cookies absence user tracking, there are numerous tracking session management techniques do not rely Cookies. TLS indicator User agents MUST make information state TLS protection available. TLS indicator] be part primary user interface usage modes entail presence signaling user only presenting page content. Otherwise, MUST be available secondary user interface. case Identity Signal, there be usage modes requirement not apply. Web content MUST NOT obscure security interface, see Obscuring disabling Security User Interfaces. User agents visual user interface make TLS indicator available consistent visual position. TLS indicator MUST present distinct state used only TLS-secured Web pages. User Agent inform users are viewing page dependent resources, was retrieved least weakly TLS protected transactions, including mixed content. user agent MAY accomplish using third state TLS indicator, mechanism dialog, info bar, other means). Error handling signaling section common error interaction requirements ordered increasing severity, practices signal following classes errors: Warning/Caution Messages Danger Messages User agents MAY communicate additional indicators users. E.g., user agent additionally display persistent indicator situation. additional security considerations concerning frequent warning messages, see Warning Fatigue. Common Error Interaction Requirements Error signaling part primary user interface be phrased terms threat user's interests, not technical occurrence. Primary user interface error messages MUST NOT be phrased solely terms art. example, certificate DNS name subjectAltName extension not match URI site user tries visit, error message explain user reaching different site, instead reporting mismatch". NOT tell user enter destination site caused error, e.g., provide feedback obtain assistance. error messages interrupt user's flow interaction, user agents enable user easily return page user was previously interacting Note ideally returning previous user agent state including results user input dynamic processing however, not be feasible circumstances. advanced users, error interactions have option request detailed description condition caused error interaction occur. error interactions discussed section typically involve communication security context information. Warning/Caution Messages Warning Caution messages are intended situations system good reason believe user be risk based current security context information, determination positively be made. Warning Caution messages MUST interrupt user's current task, such user acknowledge message. Warning Caution messages MUST provide user distinct options proceed messages MUST NOT lead situation only option presented user dismiss warning continue). options presented warnings MUST be descriptive point respective meaning be understood absence other information contained warning interaction. options offered be recommended, warning message include succinct text component denoting option recommended. absence recommended option, warning MUST present user method finding more information hyperlink, secondary window, etc) options be understood. Danger Messages Danger Messages are intended situations there positively identified danger user not merely risk). interactions communicating messages MUST be designed such user's task interrupted. interactions MUST be presented way makes impossible user go interact destination web site caused danger situation occur, first explicitly interacting Danger Message. Robustness Best Practices Keep Security Chrome Visible visual user agents, agent chrome always be present signal security context information. requirement not apply user interface explicitly dismissed user. Do not mix content security indicators extent users pay attention passive security indicators noticing understanding made difficult impossible same signal path commonly used security indicators also be controlled Web content. example, location bar commonly found agents often used display security indicator, possible icon" turn be simple copy very padlock informed attentive user look Web User Agents MUST NOT communicate positive trust information using user interface elements be mimicked chrome control web content. Site-controlled content page title, favicon) MAY be hosted chrome, content MUST NOT be displayed manner confuses hosted content chrome indicators, allowing content mimic chrome indicators position close requirement primary secondary elements visual user interfaces. particular, Web User Agents NOT use 16x16 image chrome indicate security status doing so allow favorite icon mimic Managing User Attention confronted multiple modal interactions short amount time, users are known exercise default option pressing Enter key repeatedly) sequence modal interactions stops blocking user's intended interaction. Interaction flooding attack Web site malicious intent performing unintended action installing software have required user intervention such clicking warning dialog) exploiting distraction task-focus. Web site large number new windows desired web content malicious action performed user tries close new windows clicks dialog trust decision. User interfaces used inform users security critical events solicit input MUST employ techniques prevent immediate dismissal user interface, e.g., using temporarily disabled button user interfaces make such interaction paradigm available. users interact security relevant notifications Warning/Caution Messages Web content MUST NOT be granted control user agent's interaction. Web User Agent NOT display modal security dialog related web page not currently have focus. Security dialogs include user credentials, script errors TLS errors. APIs Exposed Web Content User agents commonly allow web content perform certain manipulations agent UI functionality such opening new windows, resizing existing windows, etc. permit customization user experience. manipulations need be constrained prevent malicious sites concealing obscuring important elements agent interface, deceiving user performing dangerous acts. section requirements techniques address known attacks kind. Obscuring disabling Security User Interfaces Web user agents MUST prevent web content obscuring, hiding, disabling user interfaces display security context information, response user interaction. User agents MUST restrict window sizing moving operations consistent section Keep Security Chrome Visible. attacks agent chrome obscured moving edges visible screen. User agents MUST NOT allow web content open new windows agent's security UI hidden. Allowing operation facilitates picture-in-picture attacks, artificial chrome indicating positive security state) supplied web content place hidden UI. User agents MUST prevent web content overlaying chrome. ensure user interactions are perceived target agent chrome are not redirected Web applications. Software Installation section covers web user agent APIs allow web content download software later execution web user agent context. Web user agents MUST NOT expose programming interfaces permit installation software user intervention. User agents MUST inform user request consent user agent attempting install software agent environment result web content. interaction used MUST follow requirements Warning/Caution Messages User agents NOT provide features be used web content install software agent environment user's consent. Bookmarking APIs User agents often include features enable Web content update user's bookmarks, e.g. ECMAScript API. permitted unchecked, features serve confuse users e.g., placing bookmark same name user's bank, points attacker's site. Web user agents MUST NOT permit Web content add bookmarks explicit user consent. Web user agents MUST NOT permit Web content add URIs user's bookmark collection do not match URI page user currently Pop-up Window APIs visual user interfaces use windowed interaction paradigm, User agents restrict opening pop-up windows web content, particularly not initiated user action. Creating excessive numbers new pop-up windows technique be used condition users rapidly dismissing dialogs. be employed interaction flooding attacks. User agents offer restriction offer way extend permission individual trusted sites. Failing do so users desire functionality certain sites disable feature universally. Security Considerations Active attacks initial TLS interactions Section TLS errors leads additional exposure first TLS interaction site, even site uses validated extended validation certificates: active attacker show self-signed certificate, cause only weak warning signals user. Traditional user agents react scenario dialog box user's flow interaction, users ability override security warning. Empirical evidence shows ability typically exercised users. Countermeasures threat include prior designation high-value sites, extended validation validated certificates are required stronger warning signal attack scenario described communication certification TLS expectations mechanism separate HTTP, e.g. authenticated DNS records. TLS errors pinning new certificate destination. Note newly pinned certificate be basis spoofing attack, represent refresh Self Signed Certificate. Certificate Status Checking Failures TLS Errors TLS errors) section not document intended behavior user agents certificate status check network other non-revocation reasons. time writing, deployment environment OCSP status checking fragile subject frequent failures, so inappropriate require user agents treat such failures warnings errors. However, possibility attack: site operators using fraudulently obtained, revoked, certificate attempt attack CA's revocation infrastructure way suppress revocation errors. User agent countermeasures vulnerability include: exposing failures certificate validation checks users warning Warning/Caution Messages danger Danger Messages) level messages; refusal load sites fail checks. Certificates assure identity, not security TLS certificates types self-signed, validated, augmented assurance) provide means strong encryption communications, not be understood be, treated as, blanket security assurances. particular, validated augmented assurance certificates make guarantees level owner identity verification having been performed definitions) do not represent guarantees site operated safe manner, not otherwise subject attack. Historically, issues security identity have been conflated user agent interfaces present SSL/TLS connections implementers specification are advised be cautious cognizant distinction. Binding readable" names domain names Several recommendations document concern binding domain names certificates, equally important users binding domain name/certificate actual real-world entity involved transaction. helpful, example, know not only example.com presents valid certificate, also Inc., Norway" user be interacting. case augmented assurance certificates, identity information provided be considered sufficient purpose, other validated certificates do not necessarily provide real-world identity. User agents wish provide mechanism users manually establish linkages are advised consider petnames approach Warning Fatigue Requirements document often involve warning Warning/Caution Messages Danger Messages) messages warranted conditions user agent. However, important be aware, developing user interfaces, users habituate over-frequent warnings, weakening impact messages ability effectively interrupt user's task flow. User agents are advised constrain number warnings errors presented minimum required satisfy other security guidelines. also recommended user agents phrase options messages terms action taken warning," site") rather using generic labels Mixing Augmented Assurance Validated Certificates Augmented Assurance indicator user owner author Web page being displayed be identified using information associated augmented assurance certificate. Identity signals specification only directly address displaying identity party responsible top level resource Web page. User agents choose make identities other resources affect control page's content available, do not put forward model users use such information trust decisions. identity top level resource vouches content dependent resources. resources are control top-level resource, typically identify resources using URIs domain based authority. Therefore, specification order display augmented assurance related indicators, dependent resources be strongly TLS protected using validated certificates. augmented assurance page content other strongly TLS-protected resources are not identified augmented assurance certificates, authors third party parts document be identified same extent main document. Given certain types content, example external scripts styling change containing document's entire appearance, framed content plug-ins be user's main interaction user's real interaction be content control completely different party identified main document's augmented assurance certificate. Using third party content also makes main document reliant security third party contributor, expands available attack surface service, thus giving attackers several more lines attack. agent's Same Origin policy, separately displayed Web pages same origin freely read modify other's state. Web page's origin comprised scheme, host port URI used retrieve Web page. origin not take account attributes TLS session server certificate used retrieving Web page. example, consider user agent loaded Web pages first page was retrieved, Augmented Assurance Certificate was used TLS session. second page was retrieved, different certificate, such domain validated self-signed certificate, was used. first page was retrieved using augmented assurance certificate, second page freely read write first page. Differing security presentations pages obscure relationship mind user. Dynamic content change security properties specification expressed terms fundamentally static indicators existing agent security user interfaces. indicators tend assume security properties page" not change significant way once finished loading mean detail). Strictly speaking, assumption flawed: Dynamic pages load scripts data time source techniques insertion script tags DOM run time); effect very well be page was retrieved secure Web site Augmented Assurance certificate point be control scripts are retrieved insecurely. specification not prescribe specific user interaction kind situation. TLS-protected HTTP requests caused using XMLHttpRequest API specification permits handling error situation described network error leaving behavior Web application question) causing user interaction. expected upcoming specifications XMLHttpRequest API opt former choice. Terms defined document advanced level Augmented Assurance Certificate basic level chrome HTTP transaction Identity Information identity signal Interaction flooding attack interactively accepted Location Bar mixed content pinning plug-ins Primary User Interface Secondary User Interface Strong TLS algorithms strongly TLS-protected TLS indicator TLS-protected TLS-secured validated certificate weakly TLS-protected Web Page Web User Agent References ECRYPT2009 ECRYPT2 Yearly Report Algorithms Key Lengths Edition), available http://www.ecrypt.eu.org/documents/D.SPA.7.pdf EVTLSCERT Guidelines Issuance Management Extended Validation Certificates, CA/Browser Forum, June available http://www.cabforum.org/EV_Certificate_Guidelines.pdf FAVICON Add Favicon Site, D. Hazaël-Massieux, C. Lilley, O. Théreaux, W3C work progress, available http://www.w3.org/2005/10/howto-favicon KCM Key Management Key Continuity Internet Draft, September Peter Gutmann. draft available http://tools.ietf.org/id/draft-gutmann-keycont-01.txt NESSIE Portfolio recommended cryptographic primitives, New European Schemes Signatures, Integrity, Encryption available https://www.cosic.esat.kuleuven.be/nessie/deliverables/decision-final.pdf PETNAMES Petname Systems, HPL-2005-148, Mark Stiegler, August report available http://www.hpl.hp.com/techreports/2005/HPL-2005-148.html PKIX Internet X.509 Public Key Infrastructure Certificate Certificate Revocation List Profile, RFC D. Cooper, S. Santesson, S. Farrell, S. Boeyen, R. Housley, W. Polk, May available http://www.ietf.org/rfc/rfc5280.txt RFC2119 Key words use RFCs Indicate Requirement Levels, RFC S. Bradner, March available http://www.ietf.org/rfc/rfc2119.txt RFC2560 X.509 Internet Public Key Infrastructure Online Certificate Status Protocol OCSP, RFC M. Myers, R. Ankney, A. Malpani, S. Galperin, C. Adams, June specification available http://www.ietf.org/rfc/rfc2560.txt RFC2616 Hypertext Transfer Protocol HTTP/1.1, RFC R. Fielding, J. Gettys, J. Mogul, H. Frystyk, L. Masinter, P. Leach, T. Berners-Lee, June available http://www.ietf.org/rfc/rfc2616.txt RFC2817 Upgrading TLS HTTP/1.1, RFC R. Khare, S. Lawrence, May available http://www.ietf.org/rfc/rfc2817.txt RFC2818 HTTP TLS, RFC E. Rescorla, May available http://www.ietf.org/rfc/rfc2818.txt RFC2965 HTTP State Management Mechanism, RFC D. Kristol, L. Montulli, October available http://www.ietf.org/rfc/rfc2965.txt RFC3709 Internet X.509 Public Key Infrastructure: Logotypes X.509 Certificates, RFC S. Santeson, R. Housley, T. Freeman, February available http://www.ietf.org/rfc/rfc3709.txt RFC3986 Uniform Resource Identifier Generic Syntax", RFC T. Berners-Lee, R. Fielding, L. Masinter, January available http://www.ietf.org/rfc/rfc3986.txt SSLv3 SSLv3 specification, Netscape, November specification archived http://web.archive.org/web/20080208141212/http://wp.netscape.com/eng/ssl3/ TLSv11 Transport Layer Security Protocol, RFC T. Dierks, E. Rescorla, April specification available http://www.ietf.org/rfc/rfc4346.txt TLSv12 Transport Layer Security Protocol Version RFC T. Dierks, E. Rescorla, August specification available http://www.ietf.org/rfc/rfc5246.txt WCAG20 Web Content Accessibility Guidelines B. Caldwell, M. Cooper, L. G. Reid, G. Vanderheiden W3C Recommendation December version http://www.w3.org/TR/2008/REC-WCAG20-20081211/ latest version WCAG available http://www.w3.org/TR/WCAG20/ WSC-THREATS Web User Interaction: Threat Trees, T. Roessler W3C Working Group Note progress) November version http://www.w3.org/TR/2007/NOTE-wsc-threats-20071101". latest version available http://www.w3.org/TR/wsc-threats/ WSC-USECASES Web Security Experience, Indicators Trust: Scope Use Cases, T. Close, Editor, W3C Working Group Note progress) March version http://www.w3.org/TR/2008/NOTE-wsc-usecases-20080306/ latest version available http://www.w3.org/TR/wsc-usecases/ XHR XMLHttpRequest. A. van Kesteren W3C Working Draft Progress) November version XMLHttpRequest specification http://www.w3.org/TR/2009/WD-XMLHttpRequest-20091119/ latest version specification available http://www.w3.org/TR/XMLHttpRequest/ XHR2 XMLHttpRequest Level A. van Kesteren W3C Working Draft Progress) August September version XMLHttpRequest Level specification http://www.w3.org/TR/2009/WD-XMLHttpRequest2-20090820/ latest version specification available http://www.w3.org/TR/XMLHttpRequest2/ 